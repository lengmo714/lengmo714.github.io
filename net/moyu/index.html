<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æ‘¸é±¼æ—¶é—´å·¥èµ„è®¡ç®—å™¨ - ç²¾ç¡®è®¡ç®—æ‚¨åœ¨å·¥ä½œæ—¶é—´æ‘¸é±¼èƒ½èµšå¤šå°‘é’±ï¼Œæ”¯æŒå¤šç§å·¥ä½œæ¨¡å¼">
    <meta name="keywords" content="æ‘¸é±¼è®¡ç®—å™¨,å·¥èµ„è®¡ç®—,æ—¶é—´è®¡ç®—å™¨,å·¥ä½œæ—¶é—´,è–ªèµ„è®¡ç®—">
    <title>æ‘¸é±¼æ—¶é—´å·¥èµ„è®¡ç®—å™¨ - è®¡ç®—æ‘¸é±¼æ”¶ç›Š</title>
    
    <!-- ç™¾åº¦ç»Ÿè®¡ä»£ç  -->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a9885d847279bd4780daae9222876d62";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <script src="static/js/react.production.min.js"></script>
    <script src="static/js/react-dom.production.min.js"></script>
    <script src="static/js/babel.min.js"></script>
    <script src="static/js/8e64acaaf3384097b064eed83c9e05a8.js"></script>
    
    <style>
        /* è‡ªå®šä¹‰æ ·å¼ */
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }
        
        .soft-button-glow {
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.3);
        }
        
        .break-keep {
            word-break: keep-all;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .break-normal {
            word-break: normal;
            white-space: normal;
            overflow-wrap: break-word;
        }
        
        .timer-display {
            font-size: clamp(1rem, 4vw, 2.5rem);
            line-height: 1.2;
        }
        
        .earnings-display {
            font-size: clamp(1.25rem, 5vw, 3rem);
            line-height: 1.1;
        }
        
        .button-text {
            font-size: clamp(0.875rem, 2.5vw, 1.25rem);
            line-height: 1.3;
        }
        
        @media (max-width: 640px) {
            .mobile-button-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // èŠ‚å‡æ—¥æ•°æ®ï¼ˆå†…åµŒï¼‰
        const HOLIDAYS_2025 = {
            "2025-01-01": "å…ƒæ—¦",
            "2025-01-28": "æ˜¥èŠ‚", "2025-01-29": "æ˜¥èŠ‚", "2025-01-30": "æ˜¥èŠ‚",
            "2025-01-31": "æ˜¥èŠ‚", "2025-02-01": "æ˜¥èŠ‚", "2025-02-02": "æ˜¥èŠ‚", "2025-02-03": "æ˜¥èŠ‚",
            "2025-04-05": "æ¸…æ˜èŠ‚", "2025-04-06": "æ¸…æ˜èŠ‚", "2025-04-07": "æ¸…æ˜èŠ‚",
            "2025-05-01": "åŠ³åŠ¨èŠ‚", "2025-05-02": "åŠ³åŠ¨èŠ‚", "2025-05-03": "åŠ³åŠ¨èŠ‚",
            "2025-05-04": "åŠ³åŠ¨èŠ‚", "2025-05-05": "åŠ³åŠ¨èŠ‚",
            "2025-06-09": "ç«¯åˆèŠ‚", "2025-06-10": "ç«¯åˆèŠ‚", "2025-06-11": "ç«¯åˆèŠ‚",
            "2025-09-15": "ä¸­ç§‹èŠ‚", "2025-09-16": "ä¸­ç§‹èŠ‚", "2025-09-17": "ä¸­ç§‹èŠ‚",
            "2025-10-01": "å›½åº†èŠ‚", "2025-10-02": "å›½åº†èŠ‚", "2025-10-03": "å›½åº†èŠ‚",
            "2025-10-04": "å›½åº†èŠ‚", "2025-10-05": "å›½åº†èŠ‚", "2025-10-06": "å›½åº†èŠ‚",
            "2025-10-07": "å›½åº†èŠ‚", "2025-10-08": "å›½åº†èŠ‚"
        };

        // æ‘¸é±¼æ´»åŠ¨æ•°æ®
        const ACTIVITIES = [
            { id: 'phone', name: 'åˆ·æ‰‹æœº', icon: 'ğŸ“±' },
            { id: 'drama', name: 'çœ‹å‰§', icon: 'ğŸ“º' },
            { id: 'shopping', name: 'ç½‘è´­', icon: 'ğŸ›’' },
            { id: 'tea', name: 'ä¸‹åˆèŒ¶', icon: 'â˜•' },
            { id: 'chat', name: 'èŠå¤©', icon: 'ğŸ’¬' },
            { id: 'weibo', name: 'åˆ·å¾®åš', icon: 'ğŸ”¥' },
            { id: 'game', name: 'ç©æ¸¸æˆ', icon: 'ğŸ®' },
            { id: 'novel', name: 'çœ‹å°è¯´', icon: 'ğŸ“–' },
            { id: 'daze', name: 'å‘å‘†', icon: 'ğŸ˜´' },
            { id: 'water', name: 'å–æ°´', icon: 'ğŸ’§' },
            { id: 'toilet', name: 'ä¸Šå•æ‰€', icon: 'ğŸš½' },
            { id: 'smoke', name: 'æŠ½çƒŸ', icon: 'ğŸš¬' },
            { id: 'snack', name: 'åƒé›¶é£Ÿ', icon: 'ğŸ¿' },
            { id: 'study', name: 'ç½‘ä¸Šå­¦ä¹ ', icon: 'ğŸ“š' },
            { id: 'douyin', name: 'åˆ·æŠ–éŸ³', icon: 'ğŸµ' },
            { id: 'news', name: 'çœ‹æ–°é—»', icon: 'ğŸ“°' },
            { id: 'taobao', name: 'é€›æ·˜å®', icon: 'ğŸ›ï¸' },
            { id: 'music', name: 'å¬éŸ³ä¹', icon: 'ğŸ§' },
            { id: 'rest', name: 'ä¼‘æ¯', icon: 'ğŸ˜Œ' },
            { id: 'other', name: 'å…¶ä»–', icon: 'ğŸ¤”' }
        ];

        const ACTIVITY_ICONS = {
            'åˆ·æ‰‹æœº': 'ğŸ“±', 'çœ‹å‰§': 'ğŸ“º', 'ç½‘è´­': 'ğŸ›’', 'ä¸‹åˆèŒ¶': 'â˜•',
            'èŠå¤©': 'ğŸ’¬', 'åˆ·å¾®åš': 'ğŸ”¥', 'ç©æ¸¸æˆ': 'ğŸ®', 'çœ‹å°è¯´': 'ğŸ“–',
            'å‘å‘†': 'ğŸ˜´', 'å–æ°´': 'ğŸ’§', 'ä¸Šå•æ‰€': 'ğŸš½', 'æŠ½çƒŸ': 'ğŸš¬',
            'åƒé›¶é£Ÿ': 'ğŸ¿', 'ç½‘ä¸Šå­¦ä¹ ': 'ğŸ“š', 'åˆ·æŠ–éŸ³': 'ğŸµ', 'çœ‹æ–°é—»': 'ğŸ“°',
            'é€›æ·˜å®': 'ğŸ›ï¸', 'å¬éŸ³ä¹': 'ğŸ§', 'ä¼‘æ¯': 'ğŸ˜Œ', 'å…¶ä»–': 'ğŸ¤”'
        };

        // å·¥å…·å‡½æ•°
        function formatTime(milliseconds) {
            const totalSeconds = Math.floor(milliseconds / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            const centiseconds = Math.floor((milliseconds % 1000) / 10);
            
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${centiseconds.toString().padStart(2, '0')}`;
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('zh-CN', {
                style: 'currency',
                currency: 'CNY',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        function calculateEarnings(milliseconds, monthlySalary, workdaysInMonth, dailyHours) {
            if (!monthlySalary || !workdaysInMonth || !dailyHours) return 0;
            const hourlyRate = monthlySalary / (workdaysInMonth * dailyHours);
            return (milliseconds / (1000 * 60 * 60)) * hourlyRate;
        }

        function calculateWorkdays(year, month, workMode, holidays = {}, customWorkdays) {
            if (workMode === 'custom' && customWorkdays !== undefined) {
                return Math.max(1, Math.min(31, Math.floor(customWorkdays)));
            }

            const daysInMonth = new Date(year, month, 0).getDate();
            let workdays = 0;

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month - 1, day);
                const dateStr = date.toISOString().split('T')[0];
                const dayOfWeek = date.getDay();

                if (!holidays[dateStr]) {
                    switch (workMode) {
                        case 'five-two':
                            if (dayOfWeek >= 1 && dayOfWeek <= 5) workdays++;
                            break;
                        case 'big-small-week':
                            const weekNumber = Math.floor((day - 1) / 7) + 1;
                            const isBigWeek = weekNumber % 2 === 1;
                            if ((dayOfWeek >= 1 && dayOfWeek <= 5) || (dayOfWeek === 6 && isBigWeek)) {
                                workdays++;
                            }
                            break;
                        case 'six-one':
                            if (dayOfWeek >= 1 && dayOfWeek <= 6) workdays++;
                            break;
                        default:
                            if (dayOfWeek >= 1 && dayOfWeek <= 5) workdays++;
                    }
                }
            }

            return workdays;
        }

        // æœ¬åœ°å­˜å‚¨Hook
        function useLocalStorage(key, initialValue) {
            const [value, setValue] = useState(() => {
                try {
                    const item = window.localStorage.getItem(key);
                    return item ? JSON.parse(item) : initialValue;
                } catch (error) {
                    return initialValue;
                }
            });

            const setStoredValue = useCallback((newValue) => {
                try {
                    const valueToStore = newValue instanceof Function ? newValue(value) : newValue;
                    setValue(valueToStore);
                    window.localStorage.setItem(key, JSON.stringify(valueToStore));
                } catch (error) {
                    console.error('localStorage error:', error);
                }
            }, [key, value]);

            return [value, setStoredValue];
        }

        // è®¡æ—¶å™¨Hook
        function useTimer() {
            const [isRunning, setIsRunning] = useState(false);
            const [startTime, setStartTime] = useState(null);
            const [elapsedTime, setElapsedTime] = useState(0);
            const intervalRef = useRef(null);

            const start = useCallback(() => {
                const now = Date.now();
                setStartTime(now);
                setIsRunning(true);
            }, []);

            const stop = useCallback(() => {
                setIsRunning(false);
                if (intervalRef.current) {
                    clearInterval(intervalRef.current);
                    intervalRef.current = null;
                }
            }, []);

            const reset = useCallback(() => {
                setIsRunning(false);
                setStartTime(null);
                setElapsedTime(0);
                if (intervalRef.current) {
                    clearInterval(intervalRef.current);
                    intervalRef.current = null;
                }
            }, []);

            useEffect(() => {
                if (isRunning && startTime) {
                    intervalRef.current = setInterval(() => {
                        setElapsedTime(Date.now() - startTime);
                    }, 10);
                } else if (!isRunning && intervalRef.current) {
                    clearInterval(intervalRef.current);
                    intervalRef.current = null;
                }

                return () => {
                    if (intervalRef.current) {
                        clearInterval(intervalRef.current);
                    }
                };
            }, [isRunning, startTime]);

            return { isRunning, elapsedTime, start, stop, reset };
        }

        // æ´»åŠ¨é€‰æ‹©æ¨¡æ€æ¡†
        function ActivityModal({ isOpen, onClose, onSelectActivity }) {
            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-black bg-opacity-50" onClick={onClose} />
                    <div className="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="text-xl font-bold text-gray-800">é€‰æ‹©æ‘¸é±¼è¡Œä¸º</h3>
                            <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                        <div className="grid mobile-button-grid sm:grid-cols-4 md:grid-cols-5 gap-4">
                            {ACTIVITIES.map((activity) => (
                                <button
                                    key={activity.id}
                                    onClick={() => { onSelectActivity(activity); onClose(); }}
                                    className="flex flex-col items-center p-4 rounded-lg border-2 border-gray-200 hover:border-teal-400 hover:bg-teal-50 transition-all"
                                >
                                    <span className="text-3xl mb-2">{activity.icon}</span>
                                    <span className="text-sm text-gray-700 text-center">{activity.name}</span>
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // ç¡®è®¤å¯¹è¯æ¡†
        function ConfirmDialog({ isOpen, title, message, onConfirm, onCancel, danger = false }) {
            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-black bg-opacity-50" onClick={onCancel} />
                    <div className="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md">
                        <div className="mb-6">
                            <h3 className="text-xl font-bold text-gray-800 mb-3">{title}</h3>
                            <p className="text-gray-600">{message}</p>
                        </div>
                        <div className="flex space-x-3">
                            <button
                                onClick={onCancel}
                                className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
                            >
                                å–æ¶ˆ
                            </button>
                            <button
                                onClick={onConfirm}
                                className={`flex-1 px-4 py-2 rounded-lg text-white font-medium ${
                                    danger ? 'bg-red-500 hover:bg-red-600' : 'bg-teal-500 hover:bg-teal-600'
                                }`}
                            >
                                ç¡®è®¤
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // è®¾ç½®é¢æ¿
        function SettingsPanel({ settings, onSettingsChange, workdaysInMonth, currentDate }) {
            const hourlyRate = settings.monthlySalary / (workdaysInMonth * settings.dailyHours);
            const [customInput, setCustomInput] = useState(settings.customWorkdays?.toString() || '');

            const handleSettingChange = (key, value) => {
                onSettingsChange({ ...settings, [key]: value });
            };

            const handleCustomBlur = () => {
                const value = parseInt(customInput) || 22;
                const finalValue = Math.max(1, Math.min(31, value));
                handleSettingChange('customWorkdays', finalValue);
                setCustomInput(finalValue.toString());
            };

            return (
                <div className="bg-white rounded-2xl shadow-lg p-6 space-y-6">
                    <h2 className="text-2xl font-bold text-gray-800">åŸºç¡€ä¿¡æ¯è®¾ç½®</h2>

                    <div className="bg-gradient-to-r from-teal-50 to-blue-50 rounded-lg p-4">
                        <label className="block text-sm font-medium text-gray-600 mb-2">å½“å‰æ—¥æœŸ</label>
                        <div className="text-lg font-semibold text-gray-800">{currentDate}</div>
                    </div>

                    <div className="bg-gradient-to-r from-teal-50 to-blue-50 rounded-lg p-4">
                        <label className="block text-sm font-medium text-gray-600 mb-2">æœ¬æœˆå·¥ä½œæ—¥</label>
                        <div className="text-lg font-semibold text-teal-600">{workdaysInMonth} å¤©</div>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">æœˆè–ª</label>
                        <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">Â¥</span>
                            <input
                                type="number"
                                value={settings.monthlySalary || ''}
                                onChange={(e) => handleSettingChange('monthlySalary', parseFloat(e.target.value) || 0)}
                                className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none"
                                placeholder="è¯·è¾“å…¥æ‚¨çš„æœˆè–ª"
                            />
                        </div>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-3">ä¸Šç­æ¨¡å¼</label>
                        <div className="grid grid-cols-2 gap-3">
                            {[
                                { value: 'five-two', label: 'åšäº”ä¼‘äºŒ' },
                                { value: 'big-small-week', label: 'å¤§å°å‘¨' },
                                { value: 'six-one', label: 'åšå…­ä¼‘ä¸€' },
                                { value: 'custom', label: 'æ‰‹åŠ¨è¾“å…¥' }
                            ].map((mode) => (
                                <button
                                    key={mode.value}
                                    onClick={() => handleSettingChange('workMode', mode.value)}
                                    className={`p-3 rounded-lg border-2 transition-all ${
                                        settings.workMode === mode.value
                                            ? 'border-teal-500 bg-teal-50 text-teal-700'
                                            : 'border-gray-200 hover:border-gray-300 text-gray-700'
                                    }`}
                                >
                                    {mode.label}
                                </button>
                            ))}
                        </div>

                        {settings.workMode === 'custom' && (
                            <div className="mt-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg">
                                <label className="block text-sm font-medium text-gray-700 mb-2">æ¯æœˆå·¥ä½œæ—¥æ•°</label>
                                <input
                                    type="text"
                                    value={customInput}
                                    onChange={(e) => setCustomInput(e.target.value)}
                                    onBlur={handleCustomBlur}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 outline-none"
                                    placeholder="è¯·è¾“å…¥1-31ä¹‹é—´çš„æ•°å­—"
                                />
                            </div>
                        )}
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-3">
                            æ¯æ—¥å·¥ä½œæ—¶é•¿: {settings.dailyHours} å°æ—¶
                        </label>
                        <input
                            type="range"
                            min="1"
                            max="24"
                            value={settings.dailyHours}
                            onChange={(e) => handleSettingChange('dailyHours', parseInt(e.target.value))}
                            className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                        />
                        <div className="flex justify-between text-xs text-gray-500 mt-1">
                            <span>1å°æ—¶</span>
                            <span>24å°æ—¶</span>
                        </div>
                    </div>

                    <div className="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-4 border-l-4 border-yellow-400">
                        <label className="block text-sm font-medium text-gray-600 mb-2">æ¯å°æ—¶å·¥èµ„</label>
                        <div className="text-2xl font-bold text-yellow-600">
                            {isNaN(hourlyRate) ? 'Â¥0.00' : formatCurrency(hourlyRate)}
                        </div>
                    </div>
                </div>
            );
        }

        // è®¡æ—¶å™¨ç»„ä»¶
        function TimerPanel({ settings, workdaysInMonth, onAddRecord, todayStats }) {
            const { isRunning, elapsedTime, start, stop, reset } = useTimer();
            const [showActivityModal, setShowActivityModal] = useState(false);
            const [selectedActivity, setSelectedActivity] = useState(null);
            const [currentEarnings, setCurrentEarnings] = useState(0);

            useEffect(() => {
                const earnings = calculateEarnings(elapsedTime, settings.monthlySalary, workdaysInMonth, settings.dailyHours);
                setCurrentEarnings(earnings);
            }, [elapsedTime, settings.monthlySalary, workdaysInMonth, settings.dailyHours]);

            const handleStartClick = () => {
                setShowActivityModal(true);
            };

            const handleStopClick = () => {
                if (selectedActivity && elapsedTime > 0) {
                    const record = {
                        id: Date.now().toString(),
                        date: new Date().toISOString().split('T')[0],
                        startTime: new Date(Date.now() - elapsedTime).toLocaleTimeString(),
                        duration: elapsedTime,
                        activity: selectedActivity.name,
                        earnings: currentEarnings
                    };
                    onAddRecord(record);
                }
                stop();
                reset();
                setSelectedActivity(null);
            };

            const handleActivitySelect = (activity) => {
                setSelectedActivity(activity);
                start();
            };

            return (
                <div className="bg-white rounded-2xl shadow-lg p-8 text-center space-y-8">
                    <h2 className="text-2xl font-bold text-gray-800">æ‘¸é±¼è®¡æ—¶å™¨</h2>

                    <div className="min-h-[120px] flex flex-col justify-center">
                        {isRunning ? (
                            <button
                                onClick={handleStopClick}
                                className="bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white font-bold py-10 px-16 rounded-3xl text-3xl shadow-2xl transform hover:scale-105 transition-all"
                            >
                                <span className="flex items-center justify-center space-x-4">
                                    <span className="text-5xl">â¹ï¸</span>
                                    <span className="button-text">åœæ­¢æ‘¸é±¼</span>
                                </span>
                            </button>
                        ) : (
                            <button
                                onClick={handleStartClick}
                                disabled={!settings.monthlySalary || workdaysInMonth === 0}
                                className="bg-gradient-to-r from-sky-400 via-blue-500 to-cyan-500 hover:from-sky-500 hover:via-blue-600 hover:to-cyan-600 disabled:from-gray-400 disabled:to-gray-500 text-white font-bold py-10 px-16 rounded-3xl text-3xl shadow-2xl transform hover:scale-110 hover:shadow-3xl disabled:cursor-not-allowed disabled:transform-none soft-button-glow transition-all"
                            >
                                <span className="flex items-center justify-center space-x-4">
                                    <span className="text-5xl animate-bounce">ğŸ–±ï¸</span>
                                    <span className="button-text">å¼€å§‹æ‘¸é±¼</span>
                                </span>
                            </button>
                        )}
                    </div>

                    {selectedActivity && (
                        <div className="bg-gradient-to-r from-teal-50 to-blue-50 rounded-lg p-4">
                            <div className="flex items-center justify-center space-x-3">
                                <span className="text-2xl">{selectedActivity.icon}</span>
                                <span className="text-lg font-semibold text-teal-700">æ­£åœ¨{selectedActivity.name}</span>
                            </div>
                        </div>
                    )}

                    <div className="py-6">
                        <div className="timer-display font-mono font-bold text-gray-800 tracking-tight mb-2">
                            {formatTime(elapsedTime)}
                        </div>
                        <div className="text-gray-500 text-sm">æ—¶:åˆ†:ç§’.ç™¾åˆ†ç§’</div>
                    </div>

                    <div className="relative py-6">
                        <div className="text-gray-600 text-lg font-medium mb-3">æœ¬æ¬¡æ‘¸é±¼èµšå–</div>
                        <div className="earnings-display font-mono font-bold bg-gradient-to-r from-teal-600 to-blue-600 bg-clip-text text-transparent">
                            {formatCurrency(currentEarnings)}
                        </div>
                        {isRunning && (
                            <div className="absolute top-2 right-2 animate-bounce">
                                <span className="text-2xl">ğŸ’°</span>
                            </div>
                        )}
                    </div>

                    <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6">
                        <h3 className="text-lg font-semibold text-gray-800 mb-4">ä»Šæ—¥æ‘¸é±¼ç»Ÿè®¡</h3>
                        <div className="grid grid-cols-2 gap-4">
                            <div className="text-center">
                                <div className="text-2xl font-bold text-purple-600 timer-display">
                                    {formatTime(todayStats.totalDuration)}
                                </div>
                                <div className="text-sm text-gray-600">æ€»æ—¶é•¿</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-pink-600 timer-display">
                                    {formatCurrency(todayStats.totalEarnings)}
                                </div>
                                <div className="text-sm text-gray-600">æ€»æ”¶å…¥</div>
                            </div>
                        </div>
                        <div className="mt-4 text-center">
                            <span className="text-lg font-medium text-gray-700">æ‘¸é±¼ {todayStats.recordCount} æ¬¡</span>
                        </div>
                    </div>

                    <ActivityModal
                        isOpen={showActivityModal}
                        onClose={() => setShowActivityModal(false)}
                        onSelectActivity={handleActivitySelect}
                    />
                </div>
            );
        }

        // å†å²è®°å½•ç»„ä»¶
        function HistoryPanel({ records, onDeleteRecord, onClearAllRecords }) {
            const [confirmDialog, setConfirmDialog] = useState({ isOpen: false });
            const [collapsedDates, setCollapsedDates] = useState(new Set());

            const totalEarnings = records.reduce((sum, record) => sum + record.earnings, 0);
            const today = new Date().toISOString().split('T')[0];

            const showDeleteConfirm = (recordId) => {
                setConfirmDialog({ isOpen: true, recordId });
            };

            const showClearAllConfirm = () => {
                setConfirmDialog({ isOpen: true, isAll: true });
            };

            const handleConfirm = () => {
                if (confirmDialog.isAll) {
                    onClearAllRecords();
                } else if (confirmDialog.recordId) {
                    onDeleteRecord(confirmDialog.recordId);
                }
                setConfirmDialog({ isOpen: false });
            };

            const toggleDateCollapse = (date) => {
                const newCollapsed = new Set(collapsedDates);
                if (newCollapsed.has(date)) {
                    newCollapsed.delete(date);
                } else {
                    newCollapsed.add(date);
                }
                setCollapsedDates(newCollapsed);
            };

            // æŒ‰æ—¥æœŸåˆ†ç»„è®°å½•
            const recordsByDate = records.reduce((acc, record) => {
                const date = record.date;
                if (!acc[date]) acc[date] = [];
                acc[date].push(record);
                return acc;
            }, {});

            const sortedDates = Object.keys(recordsByDate).sort().reverse();

            // é»˜è®¤æŠ˜å éä»Šæ—¥è®°å½•
            useEffect(() => {
                const nonTodayDates = new Set();
                sortedDates.forEach(date => {
                    if (date !== today) nonTodayDates.add(date);
                });
                if (collapsedDates.size === 0) {
                    setCollapsedDates(nonTodayDates);
                }
            }, [sortedDates.length, today]);

            return (
                <div className="bg-white rounded-2xl shadow-lg p-6 space-y-6">
                    <div className="flex justify-between items-center">
                        <h2 className="text-2xl font-bold text-gray-800">æ‘¸é±¼å†å²</h2>
                        {records.length > 0 && (
                            <button
                                onClick={showClearAllConfirm}
                                className="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors"
                            >
                                æ¸…ç©ºè®°å½•
                            </button>
                        )}
                    </div>

                    <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-6 border-l-4 border-green-400">
                        <div className="flex justify-between items-center">
                            <div>
                                <div className="text-sm text-gray-600 mb-1">å†å²æ€»æ”¶å…¥</div>
                                <div className="text-3xl font-bold text-green-600">{formatCurrency(totalEarnings)}</div>
                            </div>
                            <div className="text-right">
                                <div className="text-sm text-gray-600 mb-1">æ‘¸é±¼è®°å½•</div>
                                <div className="text-2xl font-bold text-green-600">{records.length} æ¬¡</div>
                            </div>
                        </div>
                    </div>

                    {records.length === 0 ? (
                        <div className="text-center py-12">
                            <div className="text-6xl mb-4">ğŸ–±ï¸</div>
                            <p className="text-gray-500 text-lg">è¿˜æ²¡æœ‰æ‘¸é±¼è®°å½•</p>
                            <p className="text-gray-400 text-sm mt-2">å¼€å§‹æ‚¨çš„ç¬¬ä¸€æ¬¡æ‘¸é±¼ä¹‹æ—…å§ï¼</p>
                        </div>
                    ) : (
                        <div className="space-y-4 max-h-96 overflow-y-auto custom-scrollbar">
                            {sortedDates.map((date) => {
                                const isToday = date === today;
                                const isCollapsed = collapsedDates.has(date);
                                const dateRecords = recordsByDate[date];

                                return (
                                    <div key={date} className="space-y-2">
                                        <button
                                            onClick={() => toggleDateCollapse(date)}
                                            className="w-full flex items-center justify-between p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-all"
                                        >
                                            <div className="flex items-center space-x-2">
                                                <span className="text-base font-semibold text-gray-700">
                                                    {new Date(date).toLocaleDateString('zh-CN', {
                                                        month: 'long',
                                                        day: 'numeric',
                                                        weekday: 'short'
                                                    })}
                                                </span>
                                                {isToday && (
                                                    <span className="px-2 py-1 bg-blue-100 text-blue-600 text-xs rounded-full font-medium">
                                                        ä»Šå¤©
                                                    </span>
                                                )}
                                                <span className="text-sm text-gray-500">
                                                    {dateRecords.length}æ¬¡æ‘¸é±¼
                                                </span>
                                            </div>
                                            <div className="flex items-center space-x-3">
                                                <span className="text-sm font-medium text-green-600">
                                                    {formatCurrency(dateRecords.reduce((sum, record) => sum + record.earnings, 0))}
                                                </span>
                                                <svg 
                                                    className={`w-5 h-5 text-gray-400 transition-transform ${
                                                        isCollapsed ? 'rotate-0' : 'rotate-180'
                                                    }`}
                                                    fill="none" 
                                                    stroke="currentColor" 
                                                    viewBox="0 0 24 24"
                                                >
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                                                </svg>
                                            </div>
                                        </button>

                                        {!isCollapsed && (
                                            <div className="space-y-1 animate-fadeIn">
                                                {dateRecords.map((record) => (
                                                    <div key={record.id} className="flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                                                        <div className="flex items-center gap-3">
                                                            <span className="text-lg">{ACTIVITY_ICONS[record.activity] || 'ğŸ¤”'}</span>
                                                            <div>
                                                                <div className="font-medium text-gray-800 text-sm">{record.activity}</div>
                                                                <div className="text-xs text-gray-500">
                                                                    {record.startTime} Â· {formatTime(record.duration)}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="flex items-center gap-3">
                                                            <div className="text-right">
                                                                <div className="font-bold text-green-600 text-sm">
                                                                    {formatCurrency(record.earnings)}
                                                                </div>
                                                            </div>
                                                            <button
                                                                onClick={() => showDeleteConfirm(record.id)}
                                                                className="p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors"
                                                            >
                                                                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                                </svg>
                                                            </button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    )}

                    <ConfirmDialog
                        isOpen={confirmDialog.isOpen}
                        title={confirmDialog.isAll ? 'æ¸…ç©ºæ‰€æœ‰è®°å½•' : 'åˆ é™¤è®°å½•'}
                        message={confirmDialog.isAll ? 'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ‘¸é±¼è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚' : 'ç¡®å®šè¦åˆ é™¤è¿™æ¡æ‘¸é±¼è®°å½•å—ï¼Ÿ'}
                        onConfirm={handleConfirm}
                        onCancel={() => setConfirmDialog({ isOpen: false })}
                        danger={true}
                    />
                </div>
            );
        }

        // ä¸»åº”ç”¨ç»„ä»¶
        function App() {
            const defaultSettings = {
                monthlySalary: 8000,
                workMode: 'five-two',
                dailyHours: 8,
                customWorkdays: 22
            };

            const [settings, setSettings] = useLocalStorage('slacking-settings', defaultSettings);
            const [records, setRecords] = useLocalStorage('slacking-records', []);
            const [showDayChangeNotification, setShowDayChangeNotification] = useState(false);

            // ç¡®ä¿customWorkdayså­˜åœ¨
            useEffect(() => {
                if (!settings.customWorkdays) {
                    setSettings({ ...settings, customWorkdays: 22 });
                }
            }, []);

            // æ–°ä¸€å¤©æé†’
            useEffect(() => {
                const checkDayChange = () => {
                    const currentDate = new Date().toISOString().split('T')[0];
                    const storedLastDate = localStorage.getItem('lastAccessDate');
                    
                    if (storedLastDate && storedLastDate !== currentDate) {
                        setShowDayChangeNotification(true);
                        setTimeout(() => setShowDayChangeNotification(false), 3000);
                    }
                    
                    localStorage.setItem('lastAccessDate', currentDate);
                };

                checkDayChange();
                const interval = setInterval(checkDayChange, 60000);
                return () => clearInterval(interval);
            }, []);

            const currentDate = new Date();
            const formattedDate = currentDate.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });

            // è®¡ç®—å·¥ä½œæ—¥æ•°
            const workdaysInMonth = useMemo(() => {
                return calculateWorkdays(
                    currentDate.getFullYear(),
                    currentDate.getMonth() + 1,
                    settings.workMode,
                    HOLIDAYS_2025,
                    settings.customWorkdays
                );
            }, [currentDate, settings.workMode, settings.customWorkdays]);

            // è®¡ç®—ä»Šæ—¥ç»Ÿè®¡
            const todayStats = useMemo(() => {
                const today = currentDate.toISOString().split('T')[0];
                const todayRecords = (Array.isArray(records) ? records : []).filter(
                    record => record.date === today
                );

                return {
                    totalDuration: todayRecords.reduce((sum, record) => sum + record.duration, 0),
                    totalEarnings: todayRecords.reduce((sum, record) => sum + record.earnings, 0),
                    recordCount: todayRecords.length
                };
            }, [records, currentDate]);

            const handleAddRecord = (record) => {
                setRecords(prev => {
                    const existingRecords = Array.isArray(prev) ? prev : [];
                    return [record, ...existingRecords];
                });
            };

            const handleDeleteRecord = (recordId) => {
                setRecords(prev => (Array.isArray(prev) ? prev : []).filter(record => record.id !== recordId));
            };

            const handleClearAllRecords = () => {
                setRecords([]);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
                    <header className="bg-white shadow-sm border-b">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                            <div className="text-center">
                                <h1 className="text-4xl font-bold bg-gradient-to-r from-teal-600 to-blue-600 bg-clip-text text-transparent">
                                    æ‘¸é±¼æ—¶é—´å·¥èµ„è®¡ç®—å™¨
                                </h1>
                                <p className="mt-2 text-gray-600">è®¡ç®—æ‚¨åœ¨æ‘¸é±¼æœŸé—´èµšåˆ°äº†å¤šå°‘é’±</p>
                            </div>
                        </div>
                    </header>

                    {showDayChangeNotification && (
                        <div className="fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg" style={{animation: 'fadeIn 0.5s ease-out'}}>
                            <div className="flex items-center space-x-2">
                                <span className="text-xl">ğŸŒ…</span>
                                <span>æ–°çš„ä¸€å¤©å¼€å§‹äº†ï¼ä»Šæ—¥æ‘¸é±¼ç»Ÿè®¡å·²é‡ç½®</span>
                            </div>
                        </div>
                    )}

                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div className="lg:col-span-1">
                                <SettingsPanel
                                    settings={settings}
                                    onSettingsChange={setSettings}
                                    workdaysInMonth={workdaysInMonth}
                                    currentDate={formattedDate}
                                />
                            </div>

                            <div className="lg:col-span-1">
                                <TimerPanel
                                    settings={settings}
                                    workdaysInMonth={workdaysInMonth}
                                    onAddRecord={handleAddRecord}
                                    todayStats={todayStats}
                                />
                            </div>

                            <div className="lg:col-span-1">
                                <HistoryPanel
                                    records={records}
                                    onDeleteRecord={handleDeleteRecord}
                                    onClearAllRecords={handleClearAllRecords}
                                />
                            </div>
                        </div>
                    </main>

                    
                </div>
            );
        }

        // æ¸²æŸ“åº”ç”¨
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
    	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
        crossorigin="anonymous"></script>
    <p><ins class="adsbygoogle"
        style="display:block; text-align:center;"
        data-ad-layout="in-article"
        data-ad-format="fluid"
        data-ad-client="ca-pub-3160571902547760"
        data-ad-slot="8630948880"></ins></p>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</body>
</html>