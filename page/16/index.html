<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/16/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="南锋">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/16/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/03/16/pip%E9%97%AE%E9%A2%981/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/16/pip%E9%97%AE%E9%A2%981/" class="post-title-link" itemprop="url">pip问题Traceback (most recent call last)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-03-16 23:20:20" itemprop="dateCreated datePublished" datetime="2019-03-16T23:20:20+08:00">2019-03-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-14 18:45:01" itemprop="dateModified" datetime="2024-05-14T18:45:01+08:00">2024-05-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B8%B8%E8%A7%81bug/" itemprop="url" rel="index"><span itemprop="name">常见bug</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>刚刚在用pip安装ipython时，遇到了下面这个错误</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<blockquote>
<p>笔者这里用的是python3.7.2版本</p>
</blockquote>
<p><img src="https://pic.imgdb.cn/item/664340940ea9cb1403bb81b5.png" alt="在这里插入图片描述"><br>解决方案如下：打开python 的安装路径，到<code>python3.7\Lib\site-packages\pip</code>路径下，打开<br><code>__main__.py</code>文件，修改最后一行，<br>将原本的<code>sys.exit(_main())</code> 改为 <code>sys.exit(_main__._main())</code> ,如下图<br><img src="https://pic.imgdb.cn/item/664340940ea9cb1403bb8198.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/03/16/pip%E9%97%AE%E9%A2%982/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/16/pip%E9%97%AE%E9%A2%982/" class="post-title-link" itemprop="url">pip问题：SyntaxError:invalid syntax</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-03-16 23:04:12" itemprop="dateCreated datePublished" datetime="2019-03-16T23:04:12+08:00">2019-03-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-14 18:46:19" itemprop="dateModified" datetime="2024-05-14T18:46:19+08:00">2024-05-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B8%B8%E8%A7%81bug/" itemprop="url" rel="index"><span itemprop="name">常见bug</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>今天在使用python安装ipython时出现了下面错误</p>
<p><img src="https://pic.imgdb.cn/item/664340d90ea9cb1403bbdb61.png" alt="在这里插入图片描述"></p>
<p>解决方法很简单，退出python命令行<br>重新输入命令：<code>pip3 install ipython</code> 即可</p>
<p><img src="https://pic.imgdb.cn/item/664340d90ea9cb1403bbdb4e.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/01/26/cocos2dx-lua%E7%89%A9%E7%90%86%E5%BC%95%E6%93%8E%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/26/cocos2dx-lua%E7%89%A9%E7%90%86%E5%BC%95%E6%93%8E%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B/" class="post-title-link" itemprop="url">cocos2dx-lua物理引擎碰撞检测</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-01-26 15:33:05" itemprop="dateCreated datePublished" datetime="2019-01-26T15:33:05+08:00">2019-01-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-14 18:47:44" itemprop="dateModified" datetime="2024-05-14T18:47:44+08:00">2024-05-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">游戏开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在游戏中模拟真实的物理世界是比较麻烦的，通常都会交给物理引擎来做，比较知名的物理引擎有Box2D和Chipmunk。</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>在Cocos2d-x 2.x中，游戏直接使用物理引擎，引擎提供一个简单的CCPhysicsSprite，处理了物理引擎的body与CCSprite的关系，而物理引擎的其他元素并没有和引擎对应起来，游戏需要选择直接调用Box2D或Chipmunk的API来处理逻辑。然而直接使用物理引擎是比较复杂的，物理引擎的接口参数繁多、复杂、需要开发人员对物理引擎和Coco2d-x都很了解，才能把两者融合得很好。<br>这种情况在Cocos2d-x 3.x中有了改变，全新的Physics Integration，把Chipmunk和Box2D封装到引擎内部，开发者不必关心底层具体用的是哪个物理引擎，也不用直接调用物理引擎的接口。<br>Cocos2d-x 3.x默认使用Chipmunk作为内部物理引擎。<br>Physics Integration 做了以下深度融合：<br>（1）物理世界被融入到Scene中，即当创建一个场景时，可以指定这个场景是否使用物理引擎。<br>（2）Node自带body属性，也就是Sprite自带body属性。<br>（3）对物理引擎的Body(cc.PhysicsBody),Shape(cc.PhysicsShape),Contact(cc.PhysicsContact),Joint(cc.PhysicsJoint),World(cc.PhysicsWold)进行封装抽象，使用更加简单。<br>（4）更简单的碰撞检测监听:EventListenerPhysicsContact.</p>
<h3 id="创建带物理世界的scene"><a href="#创建带物理世界的scene" class="headerlink" title="创建带物理世界的scene"></a>创建带物理世界的scene</h3><p>使用下面方法创建带物理世界的scene:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> MainScene = class (<span class="string">&quot;MainScene&quot;</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> display.newScene(<span class="string">&quot;MainScene&quot;</span>,&#123;physics = <span class="number">2</span>&#125;)</span><br><span class="line"><span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>
<p>创建后，<code>self:getPhysicsWorld()</code>用来获取场景绑定的物理世界对象。<br><code>PhysicsWorld()</code>默认是带重力的，大小为Vect(0.0f,-98.0f),也可以通过<code>setGravity()</code>方法来改变重力值，如下：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">self</span>:getPhysicsWorld():setGravity(cc.p(<span class="number">0</span>,<span class="number">-100</span>)) </span><br></pre></td></tr></table></figure>
<p>在调试物理世界中物体运动模拟时，可以使用<code>PyhsicsWorld</code>的<code>setDebugDrawMask()</code>来开启调试模式。它能把物理世界中不可见的shape, joint和contact都可视化。当调试结束需要发布游戏的时候，需要把该<code>debug</code>开关关闭<br>关闭DEBUG，传入参数<code>cc.PhysicsWorld.DEBUGDRAW_NONE</code>。</p>
<h3 id="创建物理边界"><a href="#创建物理边界" class="headerlink" title="创建物理边界"></a>创建物理边界</h3><p>在物理世界中，所以物体均受重力的影响。物理引擎提供StaticShape创建一个不受重力影响的形状，在Cocos2d-x 2.x中，我们需要了解物理引擎的StaticShape相关的各种参数来完成边界设置。而在Cocos2d-x 3.x中，由<code>cc.PhysicsBody</code>创建边界，然后由<code>Node</code>添加到场景，<code>addChild</code>内部自动碗好吃呢个边界添加到物理世界，<code>Node</code>在这里起中介作用。<br>代码如下：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> size = display.size</span><br><span class="line"><span class="keyword">local</span> body = cc.PhysicsBody:createEdgeBox(size,cc.PHYSICSBODY_MATERIAL_DEFAULT,<span class="number">2</span>)</span><br><span class="line"><span class="keyword">local</span> edgeNode = display.newNode()</span><br><span class="line">edgeNode:setPosition(size.width/<span class="number">2</span>,size.height/<span class="number">2</span>)</span><br><span class="line">edgeNode:setPhysicsBody(body)</span><br><span class="line"><span class="built_in">self</span>:addChild(edgeNode)</span><br></pre></td></tr></table></figure>
<p><code>cc.PhysicsBody</code>包含很多工程方法，<code>createEdgeBox</code>创建一个不受重力影响的矩形边界,参数含义依次是:<br>      (1)矩形区域大小,这里设置为屏幕大小。<br>      (2)设置材质,可选参数,默认为<code>PHYSICSBODY_ MATERIAL DEFAULT</code>。<br>      (3)边线宽度,可选参数,默认为<code>1</code>。<br>      然后我们创建一个Node,把刚刚创建的body附加到Node上，并设置好Node的position为屏幕中心点。最后把Node添加到scene。<br>      Node的addChild方法,在Cocos2d-x 3. x中有对物理body做处理,它会自动把Node的body设置到scene的PhysicsWorld上去。<br>      PhysicsBody中的工程方法,针对参数设置的body大小，会自动创建对应的PhysicsBody和一个PhysicsShape, 这也是通常情况下,直接使用物理引擎创建一个body需要做的事情。Cocos2d-x 3. x的Physics Integration 极大地简化了使用物理引擎的代码量。</p>
<h3 id="创建受重力作用的sprite"><a href="#创建受重力作用的sprite" class="headerlink" title="创建受重力作用的sprite"></a>创建受重力作用的sprite</h3><p> 在Cocos2d-x 3.0中创建一个受重力作用的Sprite也很简单。首先来看代码:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> oneSprite = display.newSprite(<span class="string">&quot;game/basketball/image/basketball.png&quot;</span>)</span><br><span class="line"><span class="comment">-- local oneBody = cc.PhysicsBody:createBox(oneSprite:getContentSize(),cc.PHYSICSBODY_MATERIAL_DEFAULT,cc.p(0,0))  --矩形刚体</span></span><br><span class="line"><span class="keyword">local</span> oneBody = cc.PhysicsBody:createCircle(<span class="number">25</span>,cc.PHYSICSBODY_MATERIAL_DEFAULT,cc.p(<span class="number">0</span>,<span class="number">0</span>))      <span class="comment">--圆形刚体   </span></span><br><span class="line">oneBody:setContactTestBitmask(<span class="number">0xFFFFFFFF</span>)</span><br><span class="line">oneBody:applyImpulse(cc.p(<span class="number">0</span>,<span class="number">10000</span>))</span><br><span class="line">oneSprite:setPhysicsBody(oneBody)</span><br><span class="line">oneSprite:setPosition(x,y)</span><br><span class="line"><span class="built_in">self</span>:addChild(oneSprite)</span><br><span class="line"><span class="comment">--onBody:setGravityEnable(false)  --刚体不受重力作用</span></span><br></pre></td></tr></table></figure>
<p> 首先创建-一个<code>sprite</code>,然后用<code>cc.PhysicsBody:createBox()</code>创建一个矩形的body附加在sprite上。<code>createBox</code> 接受三个参数如下:<br>       (1)参数1,<code>cc. size</code>类型,表示矩形的长宽。<br>       (2)参数2,<code>cc.PhysicsMaterial</code>类型，表示物理材质属性，可选参数，默认为<code>cc. PHYSICSBODY MATERIAL DEFAULT</code>。手动创建材质方法如下:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc. PhysicsMaterial(density, restitution, friction)</span><br></pre></td></tr></table></figure>
<p> 其中第一个参数表示密度,第二个参数表示反弹力,第三个参数表示摩擦力。<br>(3)参数3,cc.p类型,表示body与中心点的偏移量,可选参数,默认为cc. p(0,0)。类似地,可以用下面的方法创建圆形body:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc. PhysicsBody:createCircle(radius,material,offset)</span><br></pre></td></tr></table></figure>
<p>不同于矩形的创建，第一个参数是园的半径，第二、三个参数的作用同<code>createBox</code>一样。</p>
<h3 id="碰撞检测"><a href="#碰撞检测" class="headerlink" title="碰撞检测"></a>碰撞检测</h3><p>在Cocos2d-x 中，事件派发机制做了重构，所有事件均由事件派发器统一管理。物理引擎的碰撞事件也不例外，下面的代码注册碰撞begin回调函数。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--监听碰撞</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">onContactBegin</span><span class="params">(contact)</span></span></span><br><span class="line">        <span class="keyword">local</span> tag = contact:getShapeA():getBody():getNode():getTag()</span><br><span class="line">        <span class="comment">-- print(tag)     --碰撞后的回调事件</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> contactListener = cc.EventListenerPhysicsContact:<span class="built_in">create</span>()</span><br><span class="line">    contactListener:registerScriptHandler(onContactBegin,cc.Handler.EVENT_PHYSICS_CONTACT_BEGIN)</span><br><span class="line">    <span class="keyword">local</span> eventDispatcher = cc.Director:getInstance():getEventDispatcher()</span><br><span class="line">    eventDispatcher:addEventListenerWithFixedPriority(contactListener,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>碰撞检测的所有事件由<code>cc.EventListenerPhysicsContact</code>的实例来监听,这些事件有如下几类。<br>(1) <code>cc. Handler. EVENT_ PHYSICS_ _CONTACT_ BEGIN</code>,在碰撞刚发生时,触发这个事件,并且在此次碰撞中只会被调用一次。可以通过返回<code>true</code> 或者<code>false</code> 来决定物体是否发生碰撞。需要注意的是，当这个事件的回调函数返回<code>flase</code> 时, <code>EVENT _ PHYSICS_CONTACT_ PRESOLVE</code>和<code>EVENT_ PHYSICS_ CONTACT_ POSTSOLVE</code> 将不会被触发,但<code>EVENT_ PHYSICS_ CONTACT_ SEPERATE</code>必定会触发。<br>(2) <code>cc. Handler. EVENT_ PHYSICS_ CONTACT_ PRESOLVE</code>, 发生在碰撞的每个<code>step</code>,可以通过调用<code>cc.PhysicsContactPreSolve</code>的成员函数来改变碰撞处理的一些参数设定,比如弹力和阻力等。同样可以通过返回<code>true</code>或者<code>false</code>来决定物体是否发生碰撞。<br>(3)<code> cc. Handler. EVENT_ PHYSICS_ CONTACT_ POSTSOLVE</code>,发生在碰撞计算完毕的每个<code>step</code>,可以在此做一些碰撞的后续处理,比如安全的移除某个物体等。<br> (4) <code>cc. Handler. EVENT_ PHYSICS_ CONTACT_ SEPERATE</code>,发生在碰撞结束两物体分离时,同样只会被调用一次。它与<code>onContactBegin</code>必定是成对出现的。<br> 监听器设置完毕,需要加入到引擎导演的事件分发器中。<br> 默认情况下,物理引擎中的物体都不发出碰撞事件,也就是上面的代码中的<code>onContactBegin</code>永远不会调用到。为了解决这个问题,首先需要了解<code>cc. PhysicsBody</code>的三个mask。<br>  (1) <code>CategoryBitmask body</code>,类别掩码,32位整型,也就是可以有32 个不同的类别。默认值为<code>0xFFFFFFFF</code>。<br>  (2) <code>ContactTestBitmask</code>,当两个物体接触时,用一个物体的<code>CategoryBitmask</code>与另一.个物体的<code>ContactTestBitmask</code>做逻辑<code>与</code>运算,不为0时引擎才会新建<code>PhysicsContact</code>对象,发送碰撞事件。<code>ContactTestBitmask</code>的设计是为了优化性能,并不是所有物体之间的碰撞我们都关心,所以这个<code>ContactTestBitmask</code>的默认值为<code>0x00000000</code>。<br>  (3)<code>CollisionBitmask</code>刚体碰撞掩码,当两个物体接触后,用–个物体的<code>CollisionBitmask</code>与另一个物体的<code>CategoryBitmask</code>做逻辑<code>与</code>运算,不为0时才能发生刚体碰撞,默认值为<code>0xFFFFFFFF</code>。<br> 上面的解释说明了每个掩码的作用,而掩码之间的相互作用可归纳如下:<br> (1)<code>CategoryBitmask</code>,是其他两个掩码比较的基础。<br> (2) <code>CategoryBitmask &amp; ContactTestBitmask</code>,决定是否发送事件消息。<br> (3) <code>CategoryBitmask &amp; CollisionBitmask</code>,决定是否产生刚体反弹效果。<br> (4) <code>ContactTestBitmask</code>和<code>CollisionBitmask</code>,互相之间没有联系。</p>
<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><blockquote>
<p>下面是main.lua文件的完整代码，单击屏幕任意一点会创建一个精灵，精灵之间相互碰撞后产生回调事件。</p>
</blockquote>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> MainScene = class (<span class="string">&quot;MainScene&quot;</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> display.newScene(<span class="string">&quot;MainScene&quot;</span>,&#123;physics = <span class="number">2</span>&#125;)</span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:ctor</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>:getPhysicsWorld():setGravity(cc.p(<span class="number">0</span>,<span class="number">-100</span>))    <span class="comment">--重力</span></span><br><span class="line">    <span class="built_in">self</span>:getPhysicsWorld():setDebugDrawMask(cc.PhysicsWorld.DEBUGDRAW_ALL)</span><br><span class="line">    <span class="keyword">local</span> size = display.size</span><br><span class="line">    <span class="keyword">local</span> body = cc.PhysicsBody:createEdgeBox(size,cc.PHYSICSBODY_MATERIAL_DEFAULT,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">local</span> edgeNode = display.newNode()</span><br><span class="line">    edgeNode:setPosition(size.width/<span class="number">2</span>,size.height/<span class="number">2</span>)</span><br><span class="line">    edgeNode:setPhysicsBody(body)</span><br><span class="line">    <span class="built_in">self</span>:addChild(edgeNode)</span><br><span class="line">    <span class="comment">--监听碰撞</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">onContactBegin</span><span class="params">(contact)</span></span></span><br><span class="line">        <span class="keyword">local</span> tag = contact:getShapeA():getBody():getNode():getTag()</span><br><span class="line">        <span class="comment">-- print(tag)     --碰撞后的回调事件</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> contactListener = cc.EventListenerPhysicsContact:<span class="built_in">create</span>()</span><br><span class="line">    contactListener:registerScriptHandler(onContactBegin,cc.Handler.EVENT_PHYSICS_CONTACT_BEGIN)</span><br><span class="line">    <span class="keyword">local</span> eventDispatcher = cc.Director:getInstance():getEventDispatcher()</span><br><span class="line">    eventDispatcher:addEventListenerWithFixedPriority(contactListener,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">self</span>:getPhysicsWorld():setDebugDrawMask(cc.PhysicsWorld.DEBUGDRAW_ALL)</span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">onTouchBegan</span><span class="params">( touch, event )</span></span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>  </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">onTouchEnded</span><span class="params">( touch, event )</span></span></span><br><span class="line">        <span class="keyword">local</span> location = touch:getLocation()   <span class="comment">--获取鼠标的位置</span></span><br><span class="line">        <span class="keyword">local</span> event_x = location[<span class="string">&quot;x&quot;</span>] <span class="keyword">or</span> <span class="number">0</span>      </span><br><span class="line">        <span class="keyword">local</span> event_y = location[<span class="string">&quot;y&quot;</span>] <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">        <span class="built_in">self</span>:addSprite(event_x,event_y)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">onTouchMoved</span><span class="params">(touch, event)</span></span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">local</span> listener1 = cc.EventListenerTouchOneByOne:<span class="built_in">create</span>()  <span class="comment">--创建一个单点事件监听</span></span><br><span class="line">    listener1:setSwallowTouches(<span class="literal">false</span>)  <span class="comment">--是否向下传递</span></span><br><span class="line">    listener1:registerScriptHandler(onTouchBegan,cc.Handler.EVENT_TOUCH_BEGAN )</span><br><span class="line">    listener1:registerScriptHandler(onTouchMoved,cc.Handler.EVENT_TOUCH_MOVED )</span><br><span class="line">    listener1:registerScriptHandler(onTouchEnded,cc.Handler.EVENT_TOUCH_ENDED )</span><br><span class="line">    <span class="keyword">local</span> eventDispatcher = <span class="built_in">self</span>:getEventDispatcher() </span><br><span class="line">    eventDispatcher:addEventListenerWithSceneGraphPriority(listener1, <span class="built_in">self</span>) <span class="comment">--分发监听事件</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:addSprite</span><span class="params">(x,y)</span></span></span><br><span class="line">    <span class="keyword">local</span> oneSprite = display.newSprite(<span class="string">&quot;game/basketball/image/basketball.png&quot;</span>)</span><br><span class="line">    <span class="comment">-- local oneBody = cc.PhysicsBody:createBox(oneSprite:getContentSize(),cc.PHYSICSBODY_MATERIAL_DEFAULT,cc.p(0,0))  --矩形刚体</span></span><br><span class="line">    <span class="keyword">local</span> oneBody = cc.PhysicsBody:createCircle(<span class="number">25</span>,cc.PHYSICSBODY_MATERIAL_DEFAULT,cc.p(<span class="number">0</span>,<span class="number">0</span>))      <span class="comment">--圆形刚体   </span></span><br><span class="line">    oneBody:setContactTestBitmask(<span class="number">0xFFFFFFFF</span>)</span><br><span class="line">    oneBody:applyImpulse(cc.p(<span class="number">0</span>,<span class="number">10000</span>))</span><br><span class="line">    oneSprite:setPhysicsBody(oneBody)</span><br><span class="line">    oneSprite:setPosition(x,y)</span><br><span class="line">    oneSprite:setTag(<span class="number">101</span>)</span><br><span class="line">    <span class="built_in">self</span>:addChild(oneSprite)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:showWithScene</span><span class="params">(transition, time, more)</span></span></span><br><span class="line">    <span class="built_in">self</span>:setVisible(<span class="literal">true</span>)</span><br><span class="line">    <span class="keyword">local</span> scene = <span class="built_in">self</span></span><br><span class="line">    display.runScene(scene, transition, <span class="built_in">time</span>, more)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">self</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> MainScene</span><br></pre></td></tr></table></figure>
<p>首先，使用	<code>display.newPhysicsScene</code>作为MainScene的父类,创建一个带物理世界的MainScene。<br>在MainScene:ctor中依次做了下面的初始化工作:<br>(1)修改物理世界的重力,重力是从cc. p(0,0)到setGravity()参数点之间的向量。<br>(2)用<code>cc. PhysicsBody: createEdgeBox</code>在屏幕四周创建物理边界，然后通过节点添加到场景中,它不受重力的影响。<br>(3)注册<code>EVENT_ PHYSICS_ CONTACT_ BEGIN</code>事件的回调函数。</p>
<blockquote>
<p>注: onContactBegin需要return true,否则物体碰撞后不发生刚体反弹。</p>
</blockquote>
<p>(4)打开物理世界的调试模式,可以在屏幕上看到物理边界以及刚体的框架。<br>(5)注册触摸事件,每次触摸事件到来都会在触摸点创建一个刚体精灵。<br><code>MainScene: addSprite</code>完成精灵的创建以及初始化:<br>(1)xxxx.png是个圆形的图片,通过这种图片创建精灵。<br>(2) <code>cc. PhysicsBody: createCircle</code>创建一个圆形的刚体,注意到它采用了radius作为第一个参数,这样刚体就能完全吻合图片的形状。<br>(3)<code>setContactTestBitmask</code>修改精灵的接触检测掩码,这样精灵之间碰撞就能发出事件。<br>(4)我们还用<code>applyImpulse</code>为刚体施加了一个向，上的瞬时冲力,这样精灵创建后会先向上飞,再掉落下来。<code>applyImpulse</code>是个很有用的接口,在物理世界中,用这个接口来改变物体的运动轨迹,而不是用传统的<code>setPos</code>,否则物理世界的运动将不可预期。<br>(5)<code>setPhysicsBody</code>把物理刚体和精灵都绑定在一起。<br>(6)设置精灵的初始坐标并添加到场景上。<br>快速单机屏幕创建多个精灵，发现它们互相弹开了，这是由于刚体的弹力作用，然后由于受到重力的影响，最终他们都凋落到屏幕下方。<br>设置刚体属性,参数分别是密度，碰撞系数，摩擦力</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc.PhysicsMaterial(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h4 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h4><p><img src="https://pic.imgdb.cn/item/664341310ea9cb1403bc2fe2.gif" alt="在这里插入图片描述"></p>
<h3 id="掩码说明"><a href="#掩码说明" class="headerlink" title="掩码说明"></a>掩码说明</h3><pre><code>  categoryBitmask：

分类掩码，定义了物体属于哪个分类。场景中的每个物理刚体可以被赋值一个多达32位的值(因为categoryBitmask为int型),每个对应32位掩码中的每一位，你在你的游戏中定义掩码值。结合collisionBitMask和contactTestBitMask属性， 你可以定义哪些物理刚体相互作用并且你的游戏何时接受这些相互作用的通知。默认值为0xFFFFFFFF(所有位都被设置)。

contactTestBitmask：

接触测试掩码，定义哪些刚体分类可以与本刚体产生相互作用的通知。当两个刚体在同一个空间，即物理世界中，每个刚体的分类掩码会和其他刚体的接触测试掩码进行逻辑与的运算。如果任意一个比较结果为非零值，产生一个PhysicsContact对象并且传递到物理世界协议中，这里协议指我们的监听器对应的回调函数。 为了最好的性能，仅设置你感兴趣的接触测试掩码中的位，也就是说通过设置接触测试掩码，你可以决定发生碰撞后，回调函数是否有响应。默认值为0x00000000(所有位都被清除)。

collisionBitmask：

碰撞掩码，定义了哪些物理刚体分类可以和这个物理刚体发生碰撞。当两个物理刚体相互接触时，可能发生碰撞。这个刚体的碰撞掩码和另一个刚体的分类掩码进行逻辑与运算比较。如果结果是一个非零值，这个刚体会发生碰撞。每个刚体独立选择接受与哪个刚体发生碰撞。例如，你可以使用此掩码来忽略那些对于本刚体的速度有影响的刚体碰撞，也就是说你可以使用此掩码使得本刚体与某些刚体碰撞不会对本刚体产生影响。默认值为0xFFFFFFFF(所有位都被设置)。

从上面三个掩码的说明中，我们可以做一个小结。假设刚体A的接触测试掩码和碰撞掩码已知，刚体B的分类掩码决定了能否和A进行碰撞和在碰撞的前提下能否发出PhysicsContact对象触发回调函数。如果B的分类掩码与A的碰撞掩码做逻辑与运算的结果为0，则不会发生碰撞，因此也不会继续和A的接触测试掩码进行逻辑与运算。如果B的分类掩码与A的碰撞掩码做逻辑与运算的结果非0，则发生碰撞，并且B的分类掩码继续与A的接触测试掩码做逻辑与运算，如果结果非0，则发出PhysicsContact对象触发回调函数。
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/01/22/cocos2dx-lua%E8%99%9A%E6%8B%9F%E6%91%87%E6%9D%86%E6%96%B9%E5%90%91%E6%8E%A7%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/01/22/cocos2dx-lua%E8%99%9A%E6%8B%9F%E6%91%87%E6%9D%86%E6%96%B9%E5%90%91%E6%8E%A7%E5%88%B6/" class="post-title-link" itemprop="url">cocos2dx-lua虚拟摇杆方向控制</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-01-22 11:53:34" itemprop="dateCreated datePublished" datetime="2019-01-22T11:53:34+08:00">2019-01-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-14 18:48:37" itemprop="dateModified" datetime="2024-05-14T18:48:37+08:00">2024-05-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">游戏开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在游戏开发中，很多时候都需要控制游戏角色的移动，比如王者荣耀中对英雄的控制，我们可以做一个虚拟摇杆来实现</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">控制层</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> CtrlLayer = class(<span class="string">&#x27;CtrlLayer&#x27;</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> display.newLayer(<span class="string">&#x27;CtrlLayer&#x27;</span>)</span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--方向按钮的size</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_w = <span class="number">265</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_h = <span class="number">265</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--方向按钮位置</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_x = display.width - btn_dir_w - <span class="number">20</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_y = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--方向按钮的中心点</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_cx = btn_dir_x + btn_dir_w/<span class="number">2</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_cy = btn_dir_y + btn_dir_h/<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--方向按钮中心圆圈的半径</span></span><br><span class="line"><span class="keyword">local</span> btn_dir_center_r = <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">构造方法</span></span><br><span class="line"><span class="comment">@param linstener 需要接收事件通知的人，需要实现事件列表中的方法</span></span><br><span class="line"><span class="comment">事件列表为：</span></span><br><span class="line"><span class="comment">    setDir(dir) : 设置了方向</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CtrlLayer:ctor</span><span class="params">(linstener)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">self</span>.linstener = linstener</span><br><span class="line"></span><br><span class="line">    <span class="built_in">self</span>:pos(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">self</span>:size(display.width, display.height)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">--方向按钮图片 </span></span><br><span class="line">    <span class="keyword">local</span> dirSprite = display.newSprite(<span class="string">&#x27;dir_btn.jpg&#x27;</span>)</span><br><span class="line">    dirSprite:setAnchorPoint(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    dirSprite:pos(btn_dir_x, btn_dir_y)</span><br><span class="line">    dirSprite:addTo(<span class="built_in">self</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">--添加触屏单点事件</span></span><br><span class="line">    <span class="built_in">self</span>:setTouchEnabled(<span class="literal">true</span>)</span><br><span class="line">    <span class="comment">--多点触控</span></span><br><span class="line">    <span class="comment">--self:setTouchMode(cc.TOUCHES_ALL_AT_ONCE)</span></span><br><span class="line">    <span class="comment">--单点触控</span></span><br><span class="line">    <span class="built_in">self</span>:setTouchMode(cc.TOUCHES_ONE_BY_ONE)</span><br><span class="line">    <span class="built_in">self</span>:addNodeEventListener(cc.NODE_TOUCH_EVENT, <span class="function"><span class="keyword">function</span><span class="params">(event)</span></span></span><br><span class="line">        <span class="keyword">if</span> event.name == <span class="string">&#x27;began&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="comment">--需要return true才能让事件继续到move/ended等</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">        <span class="keyword">elseif</span> event.name == <span class="string">&#x27;ended&#x27;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">self</span>:onTouchEnded(event)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--计算某点是否在方向按钮范围</span></span><br><span class="line"><span class="comment">--规定在方向按钮外围构成的矩形为按钮的边界</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CtrlLayer:isInDirBtn</span><span class="params">(x, y)</span></span></span><br><span class="line">    <span class="keyword">if</span> x &gt;= btn_dir_x <span class="keyword">and</span> x &lt;= (btn_dir_x + btn_dir_w) <span class="keyword">and</span> y &gt;= btn_dir_y <span class="keyword">and</span> y &lt;= (btn_dir_y + btn_dir_h) <span class="keyword">then</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--计数某点是否在方向按钮的中心圆圈内</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CtrlLayer:isInDirBtnCenter</span><span class="params">(x, y)</span></span></span><br><span class="line">    <span class="keyword">local</span> tx = <span class="built_in">math</span>.<span class="built_in">abs</span>(x-btn_dir_cx)</span><br><span class="line">    <span class="keyword">local</span> ty = <span class="built_in">math</span>.<span class="built_in">abs</span>(y-btn_dir_cy)</span><br><span class="line">    <span class="keyword">local</span> tlen = <span class="built_in">math</span>.<span class="built_in">sqrt</span>( <span class="built_in">math</span>.<span class="built_in">pow</span>(tx, <span class="number">2</span>) + <span class="built_in">math</span>.<span class="built_in">pow</span>(ty, <span class="number">2</span>) )</span><br><span class="line">    <span class="keyword">return</span> tlen &lt;= btn_dir_center_r</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--计数某点相对于方向按钮的中心点的方向</span></span><br><span class="line"><span class="comment">--规定方向有up/right/down/left</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CtrlLayer:getDir</span><span class="params">(x, y)</span></span></span><br><span class="line">    <span class="keyword">local</span> dir = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">local</span> tx = <span class="built_in">math</span>.<span class="built_in">abs</span>(x - btn_dir_cx)</span><br><span class="line">    <span class="keyword">local</span> ty = <span class="built_in">math</span>.<span class="built_in">abs</span>(y - btn_dir_cy)</span><br><span class="line">    <span class="keyword">if</span> x &gt; btn_dir_cx <span class="keyword">then</span> </span><br><span class="line">        <span class="keyword">if</span> y &gt; btn_dir_cy <span class="keyword">then</span> </span><br><span class="line">            <span class="keyword">if</span> tx &gt; ty <span class="keyword">then</span> </span><br><span class="line">                dir = <span class="string">&#x27;right&#x27;</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dir = <span class="string">&#x27;up&#x27;</span></span><br><span class="line">            <span class="keyword">end</span> </span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">if</span> tx &gt; ty <span class="keyword">then</span> </span><br><span class="line">                dir = <span class="string">&#x27;right&#x27;</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dir = <span class="string">&#x27;down&#x27;</span></span><br><span class="line">            <span class="keyword">end</span> </span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">if</span> y &gt; btn_dir_cy <span class="keyword">then</span> </span><br><span class="line">            <span class="keyword">if</span> tx &gt; ty <span class="keyword">then</span> </span><br><span class="line">                dir = <span class="string">&#x27;left&#x27;</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dir = <span class="string">&#x27;up&#x27;</span></span><br><span class="line">            <span class="keyword">end</span> </span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">if</span> tx &gt; ty <span class="keyword">then</span> </span><br><span class="line">                dir = <span class="string">&#x27;left&#x27;</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dir = <span class="string">&#x27;down&#x27;</span></span><br><span class="line">            <span class="keyword">end</span> </span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">return</span> dir </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--触屏结束</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CtrlLayer:onTouchEnded</span><span class="params">(event)</span></span></span><br><span class="line">    <span class="keyword">local</span> x, y = event.x, event.y </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">self</span>:isInDirBtn(x, y) <span class="keyword">then</span> </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">self</span>:isInDirBtnCenter(x, y) <span class="keyword">then</span> </span><br><span class="line">            <span class="keyword">local</span> dir = <span class="built_in">self</span>:getDir(x, y)</span><br><span class="line">            <span class="built_in">self</span>.linstener:setDir(dir)</span><br><span class="line">        <span class="keyword">end</span> </span><br><span class="line">    <span class="keyword">end</span> </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> CtrlLayer </span><br></pre></td></tr></table></figure>
<p>效果图如下<br><img src="https://pic.imgdb.cn/item/6643416b0ea9cb1403bc72f0.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/12/21/cocos2dx-lua%E7%83%AD%E6%9B%B4%E6%96%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/21/cocos2dx-lua%E7%83%AD%E6%9B%B4%E6%96%B0/" class="post-title-link" itemprop="url">cocos2dx-lua热更新</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-21 14:27:33" itemprop="dateCreated datePublished" datetime="2018-12-21T14:27:33+08:00">2018-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-12 09:53:40" itemprop="dateModified" datetime="2024-03-12T09:53:40+08:00">2024-03-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">游戏开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>每次登陆游戏利用cocos的assetManager从服务器拉去当前最新的两个文件。 一个是version.mainifest,一个project.mainifest. 这两个文件都是xml的描述文件。</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>一个包含了版本信息，第二个包含了游戏所有资源的MD5码。首先通过version文件对比本地的版本是否相同，如果不相同，再通过跟本地的project文件对比MD5码来判断哪些文件需要重新下载，替换资源。 </p>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤:"></a>步骤:</h2><ol>
<li>有一个文件下载的热更新服务器，将最新项目资源(res&#x2F;  src&#x2F; 目录)放入热更新服务器中，添加版本信息母文件(version_info.json)和python脚本文件eneateManifest.py(生成project.manifest、version.manifest文件)。</li>
</ol>
<p>2.version_info.json文件: 主要用来配置信息</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;packageUrl&quot;</span> : <span class="string">&quot;http://ip:port/update/MyProj/assets/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;remoteManifestUrl&quot;</span> : <span class="string">&quot;http://ip:port/update/MyProj/version/project.manifest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;remoteVersionUrl&quot;</span> : <span class="string">&quot;http://ip:port/update/MyProj/version/version.manifest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;engineVersion&quot;</span> : <span class="string">&quot;3.3&quot;</span>,</span><br><span class="line">	<span class="string">&quot;update_channel&quot;</span> : <span class="string">&quot;Android&quot;</span>,</span><br><span class="line">	<span class="string">&quot;bundle&quot;</span> : <span class="string">&quot;2018111701&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span> : <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.eneateManifest.py文件: 这个文件是一个python。目的是生成对应的version和project文件。project文件可以帮你给每个资源生成独一无二的MD5码，相当于每个资源的标记。下面是一段python文件的代码。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf<span class="number">-8</span></span><br><span class="line"> </span><br><span class="line">import <span class="built_in">os</span></span><br><span class="line">import sys</span><br><span class="line">import json</span><br><span class="line">import hashlib</span><br><span class="line">import subprocess</span><br><span class="line">import getpass</span><br><span class="line"> </span><br><span class="line">username = getpass.getuser()</span><br><span class="line"># 改变当前工作目录</span><br><span class="line">#<span class="built_in">os</span>.chdir(<span class="string">&#x27;/Users/&#x27;</span> + username + <span class="string">&#x27;/Documents/client/MyProj/&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">assetsDir = &#123;</span><br><span class="line">    #MyProj文件夹下需要进行热跟的文件夹</span><br><span class="line">    <span class="string">&quot;searchDir&quot;</span> : [<span class="string">&quot;src&quot;</span>, <span class="string">&quot;res&quot;</span>],</span><br><span class="line">    #需要忽略的文件夹</span><br><span class="line">    <span class="string">&quot;ignorDir&quot;</span> : [<span class="string">&quot;cocos&quot;</span>, <span class="string">&quot;framework&quot;</span>, <span class="string">&quot;.svn&quot;</span>],</span><br><span class="line">    #需要忽略的文件</span><br><span class="line">    <span class="string">&quot;ignorFile&quot;</span>:[<span class="string">&quot;.DS_Store&quot;</span>],</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">versionConfigFile   = <span class="string">&quot;version/version_info.json&quot;</span>  #版本信息的配置文件路径</span><br><span class="line">versionManifestPath = <span class="string">&quot;version/version.manifest&quot;</span>    #由此脚本生成的version.manifest文件路径</span><br><span class="line">projectManifestPath = <span class="string">&quot;version/project.manifest&quot;</span>    #由此脚本生成的project.manifest文件路径</span><br><span class="line"># projectManifestPath = <span class="string">&quot;/Users/ximi/Documents/client/MyProj/res/version/project.manifest&quot;</span>    #由此脚本生成的project.manifest文件路径(mac机)</span><br><span class="line"> </span><br><span class="line">class SearchFile:</span><br><span class="line">    def __init__(<span class="built_in">self</span>):</span><br><span class="line">        <span class="built_in">self</span>.fileList = []</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> assetsDir:</span><br><span class="line">            <span class="keyword">if</span> (k == <span class="string">&quot;searchDir&quot;</span>):</span><br><span class="line">                <span class="keyword">for</span> searchdire <span class="keyword">in</span> assetsDir[k]:                 </span><br><span class="line">                    <span class="built_in">self</span>.recursiveDir(searchdire)</span><br><span class="line"> </span><br><span class="line">    def recursiveDir(<span class="built_in">self</span>, srcPath):</span><br><span class="line">        <span class="string">&#x27;&#x27;</span><span class="string">&#x27; 递归指定目录下的所有文件&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">        dirList = []    #所有文件夹  </span><br><span class="line"> </span><br><span class="line">        files = <span class="built_in">os</span>.listdir(srcPath) #返回指定目录下的所有文件，及目录（不含子目录）</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> files:         </span><br><span class="line">            #目录的处理</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">os</span>.<span class="built_in">path</span>.isdir(srcPath + <span class="string">&#x27;/&#x27;</span> + f)):              </span><br><span class="line">                <span class="keyword">if</span> (f[<span class="number">0</span>] == <span class="string">&#x27;.&#x27;</span> <span class="keyword">or</span> (f <span class="keyword">in</span> assetsDir[<span class="string">&quot;ignorDir&quot;</span>])):</span><br><span class="line">                    #排除隐藏文件夹和忽略的目录</span><br><span class="line">                    pass</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    #添加非需要的文件夹                                  </span><br><span class="line">                    dirList.append(f)</span><br><span class="line"> </span><br><span class="line">            #文件的处理</span><br><span class="line">            elif (<span class="built_in">os</span>.<span class="built_in">path</span>.isfile(srcPath + <span class="string">&#x27;/&#x27;</span> + f)) <span class="keyword">and</span> (f <span class="keyword">not</span> <span class="keyword">in</span> assetsDir[<span class="string">&quot;ignorFile&quot;</span>]):               </span><br><span class="line">                <span class="built_in">self</span>.fileList.append(srcPath + <span class="string">&#x27;/&#x27;</span> + f) #添加文件</span><br><span class="line"> </span><br><span class="line">        #遍历所有子目录,并递归</span><br><span class="line">        <span class="keyword">for</span> dire <span class="keyword">in</span> dirList:        </span><br><span class="line">            #递归目录下的文件</span><br><span class="line">            <span class="built_in">self</span>.recursiveDir(srcPath + <span class="string">&#x27;/&#x27;</span> + dire)</span><br><span class="line"> </span><br><span class="line">    def getAllFile(<span class="built_in">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;</span><span class="string">&#x27; get all file path&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> tuple(<span class="built_in">self</span>.fileList)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def CalcMD5(filepath):</span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&#x27;generate a md5 code by a file path&#x27;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    with open(filepath,&#x27;rb&#x27;) as f:</span></span><br><span class="line"><span class="string">        md5obj = hashlib.md5()</span></span><br><span class="line"><span class="string">        md5obj.update(f.read())</span></span><br><span class="line"><span class="string">        return md5obj.hexdigest()</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">def getVersionInfo():</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;get version config data&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    configFile = open(versionConfigFile,&quot;</span>r<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    json_data = json.load(configFile)</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    configFile.close()</span></span><br><span class="line"><span class="string">    # json_data[&quot;</span>version<span class="string">&quot;] = json_data[&quot;</span>version<span class="string">&quot;] + &#x27;.&#x27; + str(GetSvnCurrentVersion())</span></span><br><span class="line"><span class="string">    json_data[&quot;</span>version<span class="string">&quot;] = json_data[&quot;</span>version<span class="string">&quot;]</span></span><br><span class="line"><span class="string">    return json_data</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">def GenerateVersionManifestFile():</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27; 生成大版本的version.manifest&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    json_str = json.dumps(getVersionInfo(), indent = 2)</span></span><br><span class="line"><span class="string">    fo = open(versionManifestPath,&quot;</span>w<span class="string">&quot;)  </span></span><br><span class="line"><span class="string">    fo.write(json_str)  </span></span><br><span class="line"><span class="string">    fo.close()</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">def GenerateProjectManifestFile():</span></span><br><span class="line"><span class="string">    searchfile = SearchFile()</span></span><br><span class="line"><span class="string">    fileList = list(searchfile.getAllFile())</span></span><br><span class="line"><span class="string">    project_str = &#123;&#125;</span></span><br><span class="line"><span class="string">    project_str.update(getVersionInfo())</span></span><br><span class="line"><span class="string">    dataDic = &#123;&#125;</span></span><br><span class="line"><span class="string">    for f in fileList:      </span></span><br><span class="line"><span class="string">        dataDic[f] = &#123;&quot;</span>md5<span class="string">&quot; : CalcMD5(f)&#125;</span></span><br><span class="line"><span class="string">        print f</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    project_str.update(&#123;&quot;</span>assets<span class="string">&quot;:dataDic&#125;)</span></span><br><span class="line"><span class="string">    json_str = json.dumps(project_str, sort_keys = True, indent = 2)</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    fo = open(projectManifestPath,&quot;</span>w<span class="string">&quot;)  </span></span><br><span class="line"><span class="string">    fo.write(json_str)  </span></span><br><span class="line"><span class="string">    fo.close()</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">if __name__ == &quot;</span>__main__<span class="string">&quot;:</span></span><br><span class="line"><span class="string">    GenerateVersionManifestFile()</span></span><br><span class="line"><span class="string">    GenerateProjectManifestFile()</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>生成version.manifest如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;packageUrl&quot;</span>: <span class="string">&quot;http://ip:port/update/MyProj/assets/&quot;</span>, </span><br><span class="line">  <span class="string">&quot;engineVersion&quot;</span>: <span class="string">&quot;3.3&quot;</span>, </span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>, </span><br><span class="line">  <span class="string">&quot;remoteVersionUrl&quot;</span>: <span class="string">&quot;http://ip:port/update/MyProj/version/version.manifest&quot;</span>, </span><br><span class="line">  <span class="string">&quot;remoteManifestUrl&quot;</span>: <span class="string">&quot;http://ip:port/update/MyProj/version/project.manifest&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成project.manifest如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;assets&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;src/packages/mvc/init.lua&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;md5&quot;</span>: <span class="string">&quot;6b9173481a1300c5e737ad5885ebef00&quot;</span></span><br><span class="line">        &#125;, </span><br><span class="line">        <span class="string">&quot;src/protobuf.lua&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;md5&quot;</span>: <span class="string">&quot;f790fe35eb179a4341ff41d94e488a5d&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;packageUrl&quot;</span>: <span class="string">&quot;http://ip:port/update/MyProj/assets/&quot;</span>, </span><br><span class="line">    <span class="string">&quot;engineVersion&quot;</span>: <span class="string">&quot;3.3&quot;</span>, </span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>, </span><br><span class="line">    <span class="string">&quot;remoteVersionUrl&quot;</span>: <span class="string">&quot;http://ip:port/update/MyProj/version/version.manifest&quot;</span>, </span><br><span class="line">    <span class="string">&quot;remoteManifestUrl&quot;</span>: <span class="string">&quot;http://ip:port/update/MyProj/version/project.manifest&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4.游戏客户端: 利用cocos assetManager来从服务器获取文件并且进行资源的替换（这里所谓的替换并不是真正的替换，利用了Fileutils-&gt;searchPath() 设置资源文件读取的优先级。也就是老资源和代码并没有删除，而是舍弃不用。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--region *.lua</span></span><br><span class="line"><span class="comment">--Date</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">local</span> AssetsManager = class(<span class="string">&quot;AssetsManager&quot;</span>,<span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> cc.LayerColor:<span class="built_in">create</span>(cc.c4b(<span class="number">20</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">220</span>))</span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:ctor</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>:onNodeEvent(<span class="string">&quot;exit&quot;</span>, handler(<span class="built_in">self</span>, <span class="built_in">self</span>.onExitCallback))</span><br><span class="line">    <span class="built_in">self</span>:initUI()</span><br><span class="line">    <span class="built_in">self</span>:setAssetsManage()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:onExitCallback</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>.assetsManagerEx:release()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:initUI</span><span class="params">()</span></span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">local</span> hintLabel = cc.Label:createWithTTF(<span class="string">&quot;正在更新...&quot;</span>, CONFIG.TTF_FONT_2, <span class="number">20</span>)</span><br><span class="line">        :addTo(<span class="built_in">self</span>)</span><br><span class="line">        :move(<span class="number">600</span>, <span class="number">80</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">local</span> progressBg = display.newSprite(<span class="string">&quot;sprites/hyd_progress_bg.png&quot;</span>)    </span><br><span class="line">        :addTo(<span class="built_in">self</span>)</span><br><span class="line">        :move(<span class="number">600</span>, <span class="number">40</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">self</span>.progress = cc.ProgressTimer:<span class="built_in">create</span>(display.newSprite(<span class="string">&quot;sprites/hyd_progress.png&quot;</span>))</span><br><span class="line">        :addTo(progressBg)</span><br><span class="line">        :move(<span class="number">380</span>, <span class="number">19</span>)</span><br><span class="line">    <span class="built_in">self</span>.progress:setType(cc.PROGRESS_TIMER_TYPE_BAR)</span><br><span class="line">    <span class="built_in">self</span>.progress:setBarChangeRate(cc.p(<span class="number">1</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="built_in">self</span>.progress:setMidpoint(cc.p(<span class="number">0.0</span>, <span class="number">0.5</span>))</span><br><span class="line">    <span class="built_in">self</span>.progress:setPercentage(<span class="number">0</span>) </span><br><span class="line"> </span><br><span class="line">    <span class="comment">--触摸吞噬</span></span><br><span class="line">    <span class="built_in">self</span>.listener = cc.EventListenerTouchOneByOne:<span class="built_in">create</span>()</span><br><span class="line">    <span class="built_in">self</span>.listener:setSwallowTouches(<span class="literal">true</span>)</span><br><span class="line">    <span class="keyword">local</span> onTouchBegan = <span class="function"><span class="keyword">function</span> <span class="params">(touch, event)</span></span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line">    <span class="built_in">self</span>.listener:registerScriptHandler(onTouchBegan, cc.Handler.EVENT_TOUCH_BEGAN)</span><br><span class="line">    cc.Director:getInstance():getEventDispatcher():addEventListenerWithSceneGraphPriority(<span class="built_in">self</span>.listener, <span class="built_in">self</span>)   </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:setAssetsManage</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">--创建可写目录与设置搜索路径</span></span><br><span class="line">    <span class="keyword">local</span> storagePath = cc.FileUtils:getInstance():getWritablePath() .. <span class="string">&quot;NewRes/&quot;</span> </span><br><span class="line">    <span class="keyword">local</span> resPath = storagePath.. <span class="string">&#x27;/res/&#x27;</span></span><br><span class="line">    <span class="keyword">local</span> srcPath = storagePath.. <span class="string">&#x27;/src/&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (cc.FileUtils:getInstance():isDirectoryExist(storagePath)) <span class="keyword">then</span>         </span><br><span class="line">        cc.FileUtils:getInstance():createDirectory(storagePath)</span><br><span class="line">        cc.FileUtils:getInstance():createDirectory(resPath)</span><br><span class="line">        cc.FileUtils:getInstance():createDirectory(srcPath)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">local</span> searchPaths = cc.FileUtils:getInstance():getSearchPaths() </span><br><span class="line">    <span class="built_in">table</span>.<span class="built_in">insert</span>(searchPaths, <span class="number">1</span>, storagePath)  </span><br><span class="line">    <span class="built_in">table</span>.<span class="built_in">insert</span>(searchPaths, <span class="number">2</span>, resPath)</span><br><span class="line">    <span class="built_in">table</span>.<span class="built_in">insert</span>(searchPaths, <span class="number">3</span>, srcPath)</span><br><span class="line">    cc.FileUtils:getInstance():setSearchPaths(searchPaths)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">self</span>.assetsManagerEx = cc.AssetsManagerEx:<span class="built_in">create</span>(<span class="string">&quot;version/project.manifest&quot;</span>, storagePath)    </span><br><span class="line">    <span class="built_in">self</span>.assetsManagerEx:retain()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">local</span> eventListenerAssetsManagerEx = cc.EventListenerAssetsManagerEx:<span class="built_in">create</span>(<span class="built_in">self</span>.assetsManagerEx, </span><br><span class="line">       <span class="function"><span class="keyword">function</span> <span class="params">(event)</span></span></span><br><span class="line">           <span class="built_in">self</span>:handleAssetsManagerEvent(event)</span><br><span class="line">       <span class="keyword">end</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">local</span> dispatcher = cc.Director:getInstance():getEventDispatcher()</span><br><span class="line">    dispatcher:addEventListenerWithFixedPriority(eventListenerAssetsManagerEx, <span class="number">1</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">--检查版本并升级</span></span><br><span class="line">    <span class="built_in">self</span>.assetsManagerEx:update()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:handleAssetsManagerEvent</span><span class="params">(event)</span></span>    </span><br><span class="line">    <span class="keyword">local</span> eventCodeList = cc.EventAssetsManagerEx.EventCode    </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">local</span> eventCodeHand = &#123;</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ERROR_NO_LOCAL_MANIFEST] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;发生错误:本地资源清单文件未找到&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ERROR_DOWNLOAD_MANIFEST] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;发生错误:远程资源清单文件下载失败&quot;</span>)  <span class="comment">--资源服务器没有打开，</span></span><br><span class="line">            <span class="built_in">self</span>:downloadManifestError()</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ERROR_PARSE_MANIFEST] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;发生错误:资源清单文件解析失败&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.NEW_VERSION_FOUND] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;发现找到新版本&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ALREADY_UP_TO_DATE] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;已经更新到服务器最新版本&quot;</span>)            </span><br><span class="line">            <span class="built_in">self</span>:updateFinished()</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.UPDATE_PROGRESSION]= <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;更新过程的进度事件&quot;</span>)</span><br><span class="line">            <span class="built_in">self</span>.progress:setPercentage(event:getPercentByFile())</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ASSET_UPDATED] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;单个资源被更新事件&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ERROR_UPDATING] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;发生错误:更新过程中遇到错误&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.UPDATE_FINISHED] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;更新成功事件&quot;</span>)</span><br><span class="line">            <span class="built_in">self</span>:updateFinished()</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.UPDATE_FAILED] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;更新失败事件&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line"> </span><br><span class="line">        [eventCodeList.ERROR_DECOMPRESS] = <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;解压缩失败&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">local</span> eventCode = event:getEventCode()    </span><br><span class="line">    <span class="keyword">if</span> eventCodeHand[eventCode] ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">        eventCodeHand[eventCode]()</span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:updateFinished</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>:setVisible(<span class="literal">false</span>)</span><br><span class="line">    <span class="built_in">self</span>.listener:setEnabled(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AssetsManager:downloadManifestError</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>:setVisible(<span class="literal">false</span>)</span><br><span class="line">    <span class="built_in">self</span>.listener:setEnabled(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> AssetsManager</span><br><span class="line"> </span><br><span class="line"><span class="comment">--endregion</span></span><br></pre></td></tr></table></figure>
<p>Android apk 安装后在手机中还是以apk存在，apk 不可写入和删除，所以热更新下载的最新资源都存在缓存中，并添加缓存目录为最高优先级搜索目录，加载资源时从最高优先级目录中加载从而起到替换更新的作用。</p>
<p>cocos2dx中有一个热更新类AssetsManagerEx，用这个类实现热更功能时需要有两个文件，project.manifest以及version.manifest。这里主要是project.manifest文件</p>
<p>Cocos自身也封装了热更新的模块AssetsManager、AssetsManagerEx。</p>
<p>AssetsManager采用的是升级包的管理方式，首先进行版本号对比，然后根据URL获取对应的升级包，解压升级包，设置资源加载路径，通过加载writepath目录下最新文件的方式来实现更新。问题是当涉及跳版本更新，或只有一个文件被改动时，用户就要下载前面全部的升级内容，升级包会越来越大。</p>
<p>AssetsManagerEx是AssetsManager的加强版，不同的是不再使用升级包的方式，而是采用单个文件拉取的方式。首先获取本地更新配置，之后与服务器的更新配置比对，得出差异文件，之后单个拉取差异文件。当本地版本大于服务器版本时，会清理掉本地更新缓存。AssetsManagerEx也有尚未解决的问题，例如多个更新序列无法并行，只能顺序启动。另外版本后期随着项目庞大配置文件几乎包含了所有的文件信息，对比文件时间的耗时会越来越长。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/12/13/cocos2dx-lua%E5%90%84%E7%A7%8D%E5%AE%B9%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/13/cocos2dx-lua%E5%90%84%E7%A7%8D%E5%AE%B9%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">cocos2dx-lua各种容器的使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-13 13:47:13" itemprop="dateCreated datePublished" datetime="2018-12-13T13:47:13+08:00">2018-12-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-12 09:53:40" itemprop="dateModified" datetime="2024-03-12T09:53:40+08:00">2024-03-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">游戏开发</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在cocos2dx-lua开发中，经常用到容器。下面就介绍在开发中会用到的4种容器：ListView,scrollView,tableView,pageView</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="1-ListView-（列表容器）使用"><a href="#1-ListView-（列表容器）使用" class="headerlink" title="1. ListView （列表容器）使用"></a>1. ListView （列表容器）使用</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> MainScene = class(<span class="string">&quot;MainScene&quot;</span>, cc.<span class="built_in">load</span>(<span class="string">&quot;mvc&quot;</span>).ViewBase)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:onCreate</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- 测试ListView</span></span><br><span class="line">    <span class="comment">--[[</span></span><br><span class="line"><span class="comment">    注: 1.子节点如果是RichText，或是文本信息。</span></span><br><span class="line"><span class="comment">      设置setVerticalSpace()，高度间隔。adjustToRealHeight(),自适应高度。</span></span><br><span class="line"><span class="comment">        2.设置子节点的锚点信息，否则 高度不对称</span></span><br><span class="line"><span class="comment">    ]]</span><span class="comment">--</span></span><br><span class="line"> </span><br><span class="line">    <span class="built_in">self</span>.listView = ccui.ListView:<span class="built_in">create</span>();  </span><br><span class="line">    <span class="built_in">self</span>.listView:setPosition(cc.p(<span class="number">10</span>, <span class="number">10</span>));  </span><br><span class="line">    <span class="built_in">self</span>.listView:setContentSize(cc.size(<span class="number">1116</span>, <span class="number">550</span>));  </span><br><span class="line">    <span class="built_in">self</span>.listView:setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL);  </span><br><span class="line">    <span class="built_in">self</span>.listView:setBounceEnabled(<span class="literal">true</span>);  </span><br><span class="line">    <span class="built_in">self</span>.listView:setItemsMargin(<span class="number">20</span>)  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">4</span> <span class="keyword">do</span>  </span><br><span class="line">        <span class="keyword">local</span> layout = ccui.Layout:<span class="built_in">create</span>();  </span><br><span class="line">        layout:setContentSize(cc.size(<span class="number">1116</span>, <span class="number">209</span>));  </span><br><span class="line">        layout:setBackGroundColorType(ccui.LayoutBackGroundColorType.solid);  </span><br><span class="line">        layout:setBackGroundColor(cc.c3b(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>));  </span><br><span class="line">  </span><br><span class="line">        <span class="built_in">self</span>.listView:pushBackCustomItem(layout);  </span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line">    <span class="built_in">self</span>:addChild(<span class="built_in">self</span>.listView); </span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> MainScene</span><br></pre></td></tr></table></figure>
<h3 id="2-scrollView-（滚动容器）使用"><a href="#2-scrollView-（滚动容器）使用" class="headerlink" title="2. scrollView （滚动容器）使用"></a>2. scrollView （滚动容器）使用</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> MainScene = class(<span class="string">&quot;MainScene&quot;</span>, cc.<span class="built_in">load</span>(<span class="string">&quot;mvc&quot;</span>).ViewBase)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:onCreate</span><span class="params">()</span></span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">-- 测试 scrollView</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">local</span> scrollView = cc.ScrollView:<span class="built_in">create</span>()</span><br><span class="line">    <span class="keyword">local</span> layerColor = cc.LayerColor:<span class="built_in">create</span>(cc.c4b(<span class="number">100</span>, <span class="number">100</span>,<span class="number">100</span>, <span class="number">100</span>), <span class="number">700</span>, <span class="number">600</span>)</span><br><span class="line">    scrollView:setViewSize(cc.size(<span class="number">700</span>, <span class="number">300</span>))</span><br><span class="line">    scrollView:setContainer(layerColor)</span><br><span class="line">    layerColor:setPosition(cc.p(<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    scrollView:setPosition(cc.p(<span class="number">50</span>, <span class="number">50</span>))</span><br><span class="line">    <span class="built_in">self</span>:addChild(scrollView)</span><br><span class="line">    scrollView:setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL)<span class="comment">--垂直滚动</span></span><br><span class="line">    scrollView:setBounceEnabled(<span class="literal">true</span>)</span><br><span class="line">    scrollView:setDelegate()</span><br><span class="line">    scrollView:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.scrollViewDidZoom)  ,cc.SCROLLVIEW_SCRIPT_ZOOM)</span><br><span class="line">    scrollView:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.scrollViewDidScroll) ,cc.SCROLLVIEW_SCRIPT_SCROLL)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">6</span> <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">local</span> strFmt = <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;num %d&quot;</span>, i)</span><br><span class="line">        <span class="keyword">local</span> label = cc.Label:createWithSystemFont(strFmt, <span class="string">&quot;Arial&quot;</span>, <span class="number">32</span>)</span><br><span class="line">        label:setColor(cc.c3b(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        label:setPosition(cc.p(<span class="number">350</span>, <span class="number">600</span>-i*<span class="number">100</span>+<span class="number">50</span>))</span><br><span class="line">        layerColor:addChild(label)</span><br><span class="line">    <span class="keyword">end</span>    </span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:scrollViewDidZoom</span><span class="params">()</span></span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;ScrollViewDidZoom&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:scrollViewDidScroll</span><span class="params">()</span></span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;ScrollViewDidScroll&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> MainScene</span><br></pre></td></tr></table></figure>
<h3 id="tableView-使用"><a href="#tableView-使用" class="headerlink" title="tableView 使用"></a>tableView 使用</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> MainScene = class(<span class="string">&quot;MainScene&quot;</span>, cc.<span class="built_in">load</span>(<span class="string">&quot;mvc&quot;</span>).ViewBase)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:onCreate</span><span class="params">()</span></span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">-- 测试tableView2</span></span><br><span class="line">    <span class="built_in">self</span>.tableView2 = cc.TableView:<span class="built_in">create</span>(cc.size(<span class="number">200</span>, <span class="number">200</span>))</span><br><span class="line">    <span class="built_in">self</span>.tableView2:setDirection(cc.SCROLLVIEW_DIRECTION_HORIZONTAL)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:setPosition(cc.p(<span class="number">200</span>, <span class="number">200</span>))</span><br><span class="line">    <span class="built_in">self</span>.tableView2:setDelegate()</span><br><span class="line">    <span class="built_in">self</span>:addChild(<span class="built_in">self</span>.tableView2)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.scrollViewDidScroll) , cc.SCROLLVIEW_SCRIPT_SCROLL)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.scrollViewDidZoom) , cc.SCROLLVIEW_SCRIPT_ZOOM)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.tableCellTouched) , cc.TABLECELL_TOUCHED)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.cellSizeForTable) , cc.TABLECELL_SIZE_FOR_INDEX)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.tableCellAtIndex) , cc.TABLECELL_SIZE_AT_INDEX)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:registerScriptHandler(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.numberOfCellsInTableView) , cc.NUMBER_OF_CELLS_IN_TABLEVIEW)</span><br><span class="line">    <span class="built_in">self</span>.tableView2:reloadData()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:scrollViewDidScroll</span><span class="params">(view)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ScrollViewDidScroll&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:scrollViewDidZoom</span><span class="params">(view)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ScrollViewDidZoom&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:tableCellTouched</span><span class="params">(table, cell)</span></span></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> == cell <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;cell touched at index: &quot;</span>..cell:getIdx())</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:cellSizeForTable</span><span class="params">(table, idx)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">60</span>, <span class="number">60</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:tableCellAtIndex</span><span class="params">(table, idx)</span></span></span><br><span class="line">    <span class="keyword">local</span> strValue = <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%d&quot;</span>, idx)</span><br><span class="line">    <span class="keyword">local</span> cell = <span class="built_in">table</span>:dequeueCell()</span><br><span class="line">    <span class="keyword">local</span> label = <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> == cell <span class="keyword">then</span></span><br><span class="line">        cell = cc.TableViewCell:<span class="built_in">create</span>()</span><br><span class="line">        label = cc.Label:createWithSystemFont(strValue, <span class="string">&quot;Arial&quot;</span>, <span class="number">32</span>)</span><br><span class="line">        label:setPosition(cc.p(<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        label:setAnchorPoint(cc.p(<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        cell:addChild(label)</span><br><span class="line">        label:setTag(<span class="number">123</span>)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        label = cell:getChildByTag(<span class="number">123</span>)</span><br><span class="line">        <span class="keyword">if</span> label ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">            label:setString(strValue)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> cell</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:numberOfCellsInTableView</span><span class="params">(table)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> MainScene</span><br></pre></td></tr></table></figure>
<h3 id="4-pageView（翻页容器）-使用"><a href="#4-pageView（翻页容器）-使用" class="headerlink" title="4. pageView（翻页容器） 使用"></a>4. pageView（翻页容器） 使用</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> MainScene = class(<span class="string">&quot;MainScene&quot;</span>, cc.<span class="built_in">load</span>(<span class="string">&quot;mvc&quot;</span>).ViewBase)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:onCreate</span><span class="params">()</span></span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">-- 测试 pageView</span></span><br><span class="line">    <span class="keyword">local</span> pageView = ccui.PageView:<span class="built_in">create</span>()</span><br><span class="line">    <span class="comment">--设置pageView长宽</span></span><br><span class="line">    pageView:setContentSize(<span class="number">600</span>,<span class="number">600</span>)</span><br><span class="line">    <span class="comment">--设置是否响应触摸事件</span></span><br><span class="line">    pageView:setTouchEnabled(<span class="literal">true</span>)</span><br><span class="line">    <span class="comment">--设置锚点</span></span><br><span class="line">    pageView:setAnchorPoint(cc.p(<span class="number">0.5</span>,<span class="number">0.5</span>))</span><br><span class="line">    <span class="comment">--设置位置在中心位置</span></span><br><span class="line">    pageView:setPosition(display.center)</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">5</span> <span class="keyword">do</span></span><br><span class="line">        <span class="comment">---然后layout，每个layout保存一个page</span></span><br><span class="line">        <span class="keyword">local</span> layout = ccui.Layout:<span class="built_in">create</span>()</span><br><span class="line">        <span class="comment">--为了演示这里做个小图片</span></span><br><span class="line">        layout:setContentSize(<span class="number">600</span>,<span class="number">600</span>)</span><br><span class="line">        layout:setPosition(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">        <span class="comment">--创建一个button</span></span><br><span class="line">        <span class="keyword">local</span> btn= ccui.Button:<span class="built_in">create</span>(<span class="string">&quot;bt_qd.png&quot;</span>,<span class="string">&quot;bt_qd_h.png&quot;</span>,<span class="string">&quot;bt_qd.png&quot;</span>):setPosition(<span class="number">300</span>,<span class="number">300</span>)</span><br><span class="line">        layout:addChild(btn)</span><br><span class="line">        pageView:addChild(layout)<span class="comment">---一个layout 为一个page内容   page:addPage(layout)</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">--添加pageView 到场景中</span></span><br><span class="line">    <span class="built_in">self</span>:addChild(pageView)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">--添加事件响应</span></span><br><span class="line">    pageView:addEventListener(handler(<span class="built_in">self</span>, <span class="built_in">self</span>.onEvent))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">--事件响应方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MainScene:onEvent</span><span class="params">(sender,event)</span></span></span><br><span class="line">    <span class="keyword">if</span> event == ccui.PageViewEventType.turning <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">local</span> pageNum = sender:getCurrentPageIndex()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;is turning,this PageNum:&quot;</span>..pageNum)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> MainScene</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上就是cocos2dx中用到的四种容器</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/08/20/c%E8%AF%AD%E8%A8%80%E9%A2%98%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/20/c%E8%AF%AD%E8%A8%80%E9%A2%98%E5%BA%93/" class="post-title-link" itemprop="url">C语言大学生考试全面题库</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-08-20 02:00:31" itemprop="dateCreated datePublished" datetime="2018-08-20T02:00:31+08:00">2018-08-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-12 09:53:40" itemprop="dateModified" datetime="2024-03-12T09:53:40+08:00">2024-03-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">编程语言</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3160571902547760"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-3160571902547760"
     data-ad-slot="8630948880"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="计算A-B的值"><a href="#计算A-B的值" class="headerlink" title="计算A-B的值"></a>计算A-B的值</h3><p><strong>输入描述：</strong></p>
<blockquote>
<p>输入两个整数  a,b<br>输出描述描述：</p>
</blockquote>
<p>输出a-b的结果</p>
<blockquote>
<p>样式输入：7 4<br>样式输出：3</p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/08/20/c%E8%AF%AD%E8%A8%80%E9%A2%98%E5%BA%93/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/08/08/%E9%80%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E4%BA%BA%E5%91%98%E8%81%8C%E4%B8%9A%E9%81%93%E5%BE%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/08/%E9%80%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E4%BA%BA%E5%91%98%E8%81%8C%E4%B8%9A%E9%81%93%E5%BE%B7/" class="post-title-link" itemprop="url">通信科技人员职业道德</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-08-08 23:18:11" itemprop="dateCreated datePublished" datetime="2018-08-08T23:18:11+08:00">2018-08-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-12 09:53:40" itemprop="dateModified" datetime="2024-03-12T09:53:40+08:00">2024-03-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E4%BA%BA%E5%91%98%E8%81%8C%E4%B8%9A%E9%81%93%E5%BE%B7/" itemprop="url" rel="index"><span itemprop="name">通信科技人员职业道德</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>通信科技既是整个科学技术的重要组成部分，又是通信生产力中越来越突出和具有重要意义的因素。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/08/08/%E9%80%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E4%BA%BA%E5%91%98%E8%81%8C%E4%B8%9A%E9%81%93%E5%BE%B7/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2018/05/21/%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E4%B8%8D%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%BC%80wifi%E7%83%AD%E7%82%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/21/%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E4%B8%8D%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%BC%80wifi%E7%83%AD%E7%82%B9/" class="post-title-link" itemprop="url">创建WiFi热点方法分享</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-05-21 22:11:19" itemprop="dateCreated datePublished" datetime="2018-05-21T22:11:19+08:00">2018-05-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-14 18:51:05" itemprop="dateModified" datetime="2024-05-14T18:51:05+08:00">2024-05-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">教程</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>分享在拥有无线网卡、有线网路连接的笔记本和台式电脑上创建WiFi热点的详细步骤，适用于方便在其他设备上共享网络连接的场景。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/05/21/%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E4%B8%8D%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%BC%80wifi%E7%83%AD%E7%82%B9/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/10/07/%E9%80%9A%E4%BF%A1%E5%B7%A5%E7%A8%8B%E4%BA%A4%E6%8D%A2%E4%BC%A0%E8%BE%93%E5%AE%9E%E4%B9%A0%E6%8A%A5%E5%91%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南锋">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/10/07/%E9%80%9A%E4%BF%A1%E5%B7%A5%E7%A8%8B%E4%BA%A4%E6%8D%A2%E4%BC%A0%E8%BE%93%E5%AE%9E%E4%B9%A0%E6%8A%A5%E5%91%8A/" class="post-title-link" itemprop="url">通信工程交换传输实习报告</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-07 15:29:01" itemprop="dateCreated datePublished" datetime="2017-10-07T15:29:01+08:00">2017-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-05-14 19:12:52" itemprop="dateModified" datetime="2024-05-14T19:12:52+08:00">2024-05-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">课程设计</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/%E9%80%9A%E4%BF%A1%E5%B7%A5%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">通信工程</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/%E9%80%9A%E4%BF%A1%E5%B7%A5%E7%A8%8B/%E5%AE%9E%E4%B9%A0%E6%8A%A5%E5%91%8A/" itemprop="url" rel="index"><span itemprop="name">实习报告</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本学期的3-5周，我们进行了为期3周的专业实习，本次实习的内容是程控交换和光纤传输，实习地点是云塘校区理科楼B304程控交换实验室。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/10/07/%E9%80%9A%E4%BF%A1%E5%B7%A5%E7%A8%8B%E4%BA%A4%E6%8D%A2%E4%BC%A0%E8%BE%93%E5%AE%9E%E4%B9%A0%E6%8A%A5%E5%91%8A/">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">南锋</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">168</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">南锋</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
